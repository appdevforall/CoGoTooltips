<html>
 <head>
  <meta charset="utf-8"/>
  <link href="doc_style.css" rel="stylesheet"/>
 </head>
 <body>
  <a class="menu-link" href="toc.html">
   MENU
  </a>
  <hr/>
  <div class="article-content">
   <h1 data-toc="whatsnew-eap" id="whatsnew-eap.md">
    What's new in Kotlin 2.1.0-RC2
   </h1>
   <p id="-190t4n_2">
    <span class="emphasis" id="-190t4n_15">
     <a data-tooltip="No preview versions are currently available." href="eap.html#build-details" id="-190t4n_16">
      Released: November 18, 2024
     </a>
    </span>
   </p>
   <aside class="prompt" data-title="" data-type="note" id="-190t4n_3">
    <p id="-190t4n_17">
     This document doesn't cover all of the features of the Early Access Preview (EAP) release, but it highlights some major improvements.
    </p>
    <p id="-190t4n_18">
     See the full list of changes in the
     <a data-external="true" href="https://github.com/JetBrains/kotlin/releases/tag/v2.1.0-RC2" id="-190t4n_19" rel="noopener noreferrer">
      GitHub changelog
     </a>
     .
    </p>
   </aside>
   <p id="-190t4n_4">
    The Kotlin 2.1.0-RC2 release is out! This document contains some details about this EAP release.
   </p>
   <section class="chapter">
    <h2 data-toc="ide-support" id="ide-support">
     IDE support
    </h2>
    <p id="-190t4n_20">
     The Kotlin plugins that support 2.1.0-RC2 are bundled in the latest IntelliJ IDEA and Android Studio. You don't need to update the Kotlin plugin in your IDE. All you need to do is to
     <a data-tooltip="If you create new projects using the EAP version of Kotlin, you don't need to perform any additional steps. The Kotlin Plugin will do everything for you!" href="configure-build-for-eap.html" id="-190t4n_22">
      change the Kotlin version
     </a>
     to 2.1.0-RC2 in your build scripts.
    </p>
    <p id="-190t4n_21">
     See
     <a data-tooltip="To upgrade your project to a new release, you need to update your build script file. For example, to update to Kotlin 2.1.0, change the version of the Kotlin Gradle plugin in your build.gradle(.kts) file:" href="releases.html#update-to-a-new-kotlin-version" id="-190t4n_23">
      Update to a new release
     </a>
     for details.
    </p>
   </section>
   <section class="chapter">
    <h2 data-toc="language" id="language">
     Language
    </h2>
    <p id="-190t4n_24">
     After the Kotlin 2.0.0 release with the K2 compiler, the Kotlin team at JetBrains is focusing on improving the language with new features. In this release, we are excited to announce several new language design features.
    </p>
    <p id="-190t4n_25">
     These features are available in preview, and we encourage you to try them and share your feedback:
    </p>
    <ul class="list _bullet" id="-190t4n_26">
     <li class="list__item" id="-190t4n_33">
      <p>
       Guard conditions in
       <code class="code" id="-190t4n_36">
        when
       </code>
       with a subject.
       <a data-external="true" href="https://github.com/Kotlin/KEEP/blob/master/proposals/guards.md" id="-190t4n_37" rel="noopener noreferrer">
        Read the KEEP document for details
       </a>
      </p>
     </li>
     <li class="list__item" id="-190t4n_34">
      <p>
       <a data-tooltip="Kotlin 2.1.0-RC2 introduces a preview of a new feature, an ability to use non-local break and continue. It reduces boilerplate code and adds more flexibility when working with inline functions." href="#non-local-break-and-continue" id="-190t4n_38">
        Non-local
        <code class="code" id="-190t4n_39">
         break
        </code>
        and
        <code class="code" id="-190t4n_40">
         continue
        </code>
       </a>
      </p>
     </li>
     <li class="list__item" id="-190t4n_35">
      <p>
       Multidollar interpolation: improved handling of
       <code class="code" id="-190t4n_41">
        $
       </code>
       in string literals.
       <a data-external="true" href="https://github.com/Kotlin/KEEP/blob/master/proposals/dollar-escape.md" id="-190t4n_42" rel="noopener noreferrer">
        Read the KEEP document for details
       </a>
      </p>
     </li>
    </ul>
    <aside class="prompt" data-title="" data-type="tip" id="-190t4n_27">
     <p id="-190t4n_43">
      All the features have IDE support in the latest EAP version of IntelliJ IDEA with the K2 mode enabled.
     </p>
     <p id="-190t4n_44">
      Learn more in the
      <a data-external="true" href="https://blog.jetbrains.com/idea/2024/09/intellij-idea-2024-3-eap/#k2-mode-enabled-by-default" id="-190t4n_45" rel="noopener noreferrer">
       IntelliJ IDEA 2024.3 EAP blog post
      </a>
      .
     </p>
    </aside>
    <p id="-190t4n_28">
     <a data-tooltip="JetBrains evolves the Kotlin language according to the Kotlin language evolution principles, guided by pragmatic design." href="kotlin-language-features-and-proposals.html" id="-190t4n_46">
      See the full list of Kotlin language design features and proposals
     </a>
     .
    </p>
    <section class="chapter">
     <h3 data-toc="non-local-break-and-continue" id="non-local-break-and-continue">
      Non-local break and continue
     </h3>
     <p id="-190t4n_47">
      Kotlin 2.1.0-RC2 introduces a preview of a new feature, an ability to use non-local
      <code class="code" id="-190t4n_55">
       break
      </code>
      and
      <code class="code" id="-190t4n_56">
       continue
      </code>
      . It reduces boilerplate code and adds more flexibility when working with inline functions.
     </p>
     <p id="-190t4n_48">
      Previously, you could only use non-local returns in your project. Now, Kotlin also supports
      <code class="code" id="-190t4n_57">
       break
      </code>
      and
      <code class="code" id="-190t4n_58">
       continue
      </code>
      <a data-tooltip="Kotlin has three structural jump expressions:" href="returns.html" id="-190t4n_59">
       jump expressions
      </a>
      non-locally. That means that you can apply them within lambdas passed as arguments to an inline function that encloses the loop:
     </p>
     <div class="code-comparer" data-comparing="vertically" id="-190t4n_49">
      <div class="code-block" data-lang="kotlin" data-title="Before">
       fun processList(elements: List&lt;Int&gt;): Boolean {
            for (element in elements) {
                val variable = element.nullableMethod()
                if (variable == null) {
                    log.warning("Element is null or invalid, continuing...")
                    continue
                }
                if (variable == 0) return true
            }
            return false
        }
      </div>
      <div class="code-block" data-lang="kotlin" data-title="After">
       fun processList(elements: List&lt;Int&gt;): Boolean {
            for (element in elements) {
                val variable = element.nullableMethod() ?: run {
                    log.warning("Element is null or invalid, continuing...")
                    continue
                }
                if (variable == 0) return true
            }
            return false
        }
      </div>
     </div>
     <p id="-190t4n_50">
      The feature is currently
      <a data-tooltip="Here's a quick guide to these stability levels and their meaning:" href="components-stability.html#stability-levels-explained" id="-190t4n_62">
       Experimental
      </a>
      . To try it out in your project, use the
      <code class="code" id="-190t4n_63">
       -Xnon-local-break-continue
      </code>
      compiler option in the command line:
     </p>
     <div class="code-block" data-lang="bash">
      kotlinc -Xnon-local-break-continue main.kt
     </div>
     <p id="-190t4n_52">
      Or set it in the
      <code class="code" id="-190t4n_64">
       compilerOptions {}
      </code>
      block of your Gradle build file:
     </p>
     <div class="code-block" data-lang="kotlin">
      kotlin {
    compilerOptions {
        freeCompilerArgs.add("-Xnon-local-break-continue")
    }
}
     </div>
     <p id="-190t4n_54">
      We're planning to make this feature stable in future Kotlin releases. If you encounter any issues when using non-local
      <code class="code" id="-190t4n_65">
       break
      </code>
      and
      <code class="code" id="-190t4n_66">
       continue
      </code>
      , please report them to our
      <a data-external="true" href="http://kotl.in/issue" id="-190t4n_67" rel="noopener noreferrer">
       issue tracker
      </a>
      .
     </p>
    </section>
    <section class="chapter">
     <h3 data-toc="support-for-requiring-opt-in-to-extend-apis" id="support-for-requiring-opt-in-to-extend-apis">
      Support for requiring opt-in to extend APIs
     </h3>
     <p id="-190t4n_68">
      Kotlin 2.1.0-RC2 introduces the
      <a data-external="true" href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-subclass-opt-in-required/" id="-190t4n_76" rel="noopener noreferrer">
       <code class="code" id="-190t4n_77">
        @SubclassOptInRequired
       </code>
      </a>
      annotation. This annotation allows library authors to require explicit opt-in before users can implement experimental interfaces or extend experimental classes.
     </p>
     <p id="-190t4n_69">
      This feature can be useful when a library API is stable enough to use but might evolve with new abstract functions, making it unstable for inheritance.
     </p>
     <p id="-190t4n_70">
      To add the opt-in requirement to an API element, use the
      <code class="code" id="-190t4n_78">
       @SubclassOptInRequired
      </code>
      annotation with a reference to the annotation class:
     </p>
     <div class="code-block" data-lang="kotlin">
      @RequiresOptIn(
    level = RequiresOptIn.Level.WARNING,
    message = "Interfaces in this library are experimental"
)
annotation class UnstableApi()

@SubclassOptInRequired(UnstableApi::class)
interface CoreLibraryApi
     </div>
     <p id="-190t4n_72">
      In this example, the
      <code class="code" id="-190t4n_79">
       CoreLibraryApi
      </code>
      interface requires users to opt in before they can implement it. A user can opt in like this:
     </p>
     <div class="code-block" data-lang="kotlin">
      @OptIn(UnstableApi::class)
interface MyImplementation : CoreLibraryApi
     </div>
     <aside class="prompt" data-title="" data-type="note" id="-190t4n_74">
      <p id="-190t4n_80">
       When you use the
       <code class="code" id="-190t4n_81">
        @SubclassOptInRequired
       </code>
       annotation to require opt-in, the requirement is not propagated to any
       <a data-tooltip="Classes can be nested in other classes:" href="nested-classes.html" id="-190t4n_82">
        inner or nested classes
       </a>
       .
      </p>
     </aside>
     <p id="-190t4n_75">
      For a real-world example of how to use the
      <code class="code" id="-190t4n_83">
       @SubclassOptInRequired
      </code>
      annotation in your API, check out the
      <a data-external="true" href="https://kotlinlang.org/api/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines.flow/-shared-flow/" id="-190t4n_84" rel="noopener noreferrer">
       <code class="code" id="-190t4n_86">
        SharedFlow
       </code>
      </a>
      interface in the
      <code class="code" id="-190t4n_85">
       kotlinx.coroutines
      </code>
      library.
     </p>
    </section>
    <section class="chapter">
     <h3 data-toc="improved-overload-resolution-for-functions-with-generic-types" id="improved-overload-resolution-for-functions-with-generic-types">
      Improved overload resolution for functions with generic types
     </h3>
     <p id="-190t4n_87">
      Previously, if you had a number of overloads for a function where some have value parameters of generic type and others had function types at the same position, the resolution behavior was inconsistent in some cases.
     </p>
     <p id="-190t4n_88">
      This led to different behavior depending on whether your overloads were member functions or extension functions. For example:
     </p>
     <div class="code-block" data-lang="kotlin">
      class KeyValueStore&lt;K, V&gt; {
    fun store(key: K, value: V) {} // 1
    fun store(key: K, lazyValue: () -&gt; V) {} // 2
}

fun &lt;K, V&gt; KeyValueStore&lt;K, V&gt;.storeExtension(key: K, value: V) {} // 1 
fun &lt;K, V&gt; KeyValueStore&lt;K, V&gt;.storeExtension(key: K, lazyValue: () -&gt; V) {} // 2

fun test(kvs: KeyValueStore&lt;String, Int&gt;) {
    // Member functions
    kvs.store("", 1)    // Resolves to 1
    kvs.store("") { 1 } // Resolves to 2

    // Extension functions
    kvs.storeExtension("", 1)    // Resolves to 1
    kvs.storeExtension("") { 1 } // Doesn't resolve
}
     </div>
     <p id="-190t4n_90">
      In the example, the
      <code class="code" id="-190t4n_93">
       KeyValueStore
      </code>
      class has two overloads for the
      <code class="code" id="-190t4n_94">
       store()
      </code>
      function, where one overload has function parameters with generic types
      <code class="code" id="-190t4n_95">
       K
      </code>
      ,
      <code class="code" id="-190t4n_96">
       V
      </code>
      , and another has a lambda function that returns a generic type
      <code class="code" id="-190t4n_97">
       V
      </code>
      . Similarly, there are two overloads for the extension function:
      <code class="code" id="-190t4n_98">
       storeExtension()
      </code>
      .
     </p>
     <p id="-190t4n_91">
      When you called the
      <code class="code" id="-190t4n_99">
       store()
      </code>
      function with and without a lambda function, the compiler successfully resolved the correct overloads. However, when you called the extension function
      <code class="code" id="-190t4n_100">
       storeExtension()
      </code>
      with a lambda function, the compiler didn't resolve the correct overload because it incorrectly considered both overloads as applicable.
     </p>
     <p id="-190t4n_92">
      To fix this problem, we've introduced a new heuristic so that the compiler can discard a possible overload when a function parameter with generic type can't accept a lambda function based on information from a different argument. This change makes the behavior of member functions and extension functions consistent, and is enabled by default in Kotlin 2.1.0-RC2.
     </p>
    </section>
    <section class="chapter">
     <h3 data-toc="improved-exhaustiveness-checks-for-when-expressions-with-sealed-classes" id="improved-exhaustiveness-checks-for-when-expressions-with-sealed-classes">
      Improved exhaustiveness checks for when expressions with sealed classes
     </h3>
     <p id="-190t4n_101">
      In previous versions of Kotlin, the compiler required an
      <code class="code" id="-190t4n_104">
       else
      </code>
      branch in
      <code class="code" id="-190t4n_105">
       when
      </code>
      expressions for type parameters with sealed upper bounds, even when all cases in the
      <code class="code" id="-190t4n_106">
       sealed class
      </code>
      hierarchy were covered. This behavior is addressed and improved in Kotlin 2.1.0-RC2, making exhaustiveness checks more powerful and allowing you to remove redundant
      <code class="code" id="-190t4n_107">
       else
      </code>
      branches. This keeps
      <code class="code" id="-190t4n_108">
       when
      </code>
      expressions cleaner and more intuitive.
     </p>
     <p id="-190t4n_102">
      Here's an example demonstrating the change:
     </p>
     <div class="code-block" data-lang="kotlin">
      sealed class Result
object Error : Result()
class Success(val value: String) : Result()

fun &lt;T : Result&gt; render(result: T) = when (result) {
    Error -&gt; "Error!"
    is Success -&gt; result.value
    // Requires no else branch
}
     </div>
    </section>
   </section>
   <section class="chapter">
    <h2 data-toc="kotlin-k2-compiler" id="kotlin-k2-compiler">
     Kotlin K2 compiler
    </h2>
    <p id="-190t4n_109">
     With Kotlin 2.1.0-RC2, the K2 compiler now provides more flexibility when working with compiler checks and warnings, as well as improved support for the kapt plugin.
    </p>
    <section class="chapter">
     <h3 data-toc="extra-compiler-checks" id="extra-compiler-checks">
      Extra compiler checks
     </h3>
     <p id="-190t4n_113">
      With Kotlin 2.1.0-RC2, you can now enable additional checks in the K2 compiler. These are extra declaration, expression, and type checks that are usually not crucial for compilation, but can still be useful if you want to validate the following cases:
     </p>
     <div class="table-wrapper">
      <table class="wide" id="-190t4n_114">
       <thead>
        <tr class="ijRowHead" id="-190t4n_119">
         <th id="-190t4n_135">
          <p>
           Check type
          </p>
         </th>
         <th id="-190t4n_136">
          <p>
           Comment
          </p>
         </th>
        </tr>
       </thead>
       <tbody>
        <tr id="-190t4n_120">
         <td id="-190t4n_137">
          <p>
           <code class="code" id="-190t4n_139">
            REDUNDANT_NULLABLE
           </code>
          </p>
         </td>
         <td id="-190t4n_138">
          <p>
           <code class="code" id="-190t4n_140">
            Boolean??
           </code>
           is used instead of
           <code class="code" id="-190t4n_141">
            Boolean?
           </code>
          </p>
         </td>
        </tr>
        <tr id="-190t4n_121">
         <td id="-190t4n_142">
          <p>
           <code class="code" id="-190t4n_144">
            PLATFORM_CLASS_MAPPED_TO_KOTLIN
           </code>
          </p>
         </td>
         <td id="-190t4n_143">
          <p>
           <code class="code" id="-190t4n_145">
            java.lang.String
           </code>
           is used instead of
           <code class="code" id="-190t4n_146">
            kotlin.String
           </code>
          </p>
         </td>
        </tr>
        <tr id="-190t4n_122">
         <td id="-190t4n_147">
          <p>
           <code class="code" id="-190t4n_149">
            ARRAY_EQUALITY_OPERATOR_CAN_BE_REPLACED_WITH_EQUALS
           </code>
          </p>
         </td>
         <td id="-190t4n_148">
          <p>
           <code class="code" id="-190t4n_150">
            arrayOf("") == arrayOf("")
           </code>
           is used instead of
           <code class="code" id="-190t4n_151">
            arrayOf("").contentEquals(arrayOf(""))
           </code>
          </p>
         </td>
        </tr>
        <tr id="-190t4n_123">
         <td id="-190t4n_152">
          <p>
           <code class="code" id="-190t4n_154">
            REDUNDANT_CALL_OF_CONVERSION_METHOD
           </code>
          </p>
         </td>
         <td id="-190t4n_153">
          <p>
           <code class="code" id="-190t4n_155">
            42.toInt()
           </code>
           is used instead of
           <code class="code" id="-190t4n_156">
            42
           </code>
          </p>
         </td>
        </tr>
        <tr id="-190t4n_124">
         <td id="-190t4n_157">
          <p>
           <code class="code" id="-190t4n_159">
            USELESS_CALL_ON_NOT_NULL
           </code>
          </p>
         </td>
         <td id="-190t4n_158">
          <p>
           <code class="code" id="-190t4n_160">
            "".orEmpty()
           </code>
           is used instead of
           <code class="code" id="-190t4n_161">
            ""
           </code>
          </p>
         </td>
        </tr>
        <tr id="-190t4n_125">
         <td id="-190t4n_162">
          <p>
           <code class="code" id="-190t4n_164">
            REDUNDANT_SINGLE_EXPRESSION_STRING_TEMPLATE
           </code>
          </p>
         </td>
         <td id="-190t4n_163">
          <p>
           <code class="code" id="-190t4n_165">
            "$string"
           </code>
           is used instead of
           <code class="code" id="-190t4n_166">
            string
           </code>
          </p>
         </td>
        </tr>
        <tr id="-190t4n_126">
         <td id="-190t4n_167">
          <p>
           <code class="code" id="-190t4n_169">
            UNUSED_ANONYMOUS_PARAMETER
           </code>
          </p>
         </td>
         <td id="-190t4n_168">
          <p>
           A parameter is passed in the lambda expression but never used
          </p>
         </td>
        </tr>
        <tr id="-190t4n_127">
         <td id="-190t4n_170">
          <p>
           <code class="code" id="-190t4n_172">
            REDUNDANT_VISIBILITY_MODIFIER
           </code>
          </p>
         </td>
         <td id="-190t4n_171">
          <p>
           <code class="code" id="-190t4n_173">
            public class Klass
           </code>
           is used instead of
           <code class="code" id="-190t4n_174">
            class Klass
           </code>
          </p>
         </td>
        </tr>
        <tr id="-190t4n_128">
         <td id="-190t4n_175">
          <p>
           <code class="code" id="-190t4n_177">
            REDUNDANT_MODALITY_MODIFIER
           </code>
          </p>
         </td>
         <td id="-190t4n_176">
          <p>
           <code class="code" id="-190t4n_178">
            final class Klass
           </code>
           is used instead of
           <code class="code" id="-190t4n_179">
            class Klass
           </code>
          </p>
         </td>
        </tr>
        <tr id="-190t4n_129">
         <td id="-190t4n_180">
          <p>
           <code class="code" id="-190t4n_182">
            REDUNDANT_SETTER_PARAMETER_TYPE
           </code>
          </p>
         </td>
         <td id="-190t4n_181">
          <p>
           <code class="code" id="-190t4n_183">
            set(value: Int)
           </code>
           is used instead of
           <code class="code" id="-190t4n_184">
            set(value)
           </code>
          </p>
         </td>
        </tr>
        <tr id="-190t4n_130">
         <td id="-190t4n_185">
          <p>
           <code class="code" id="-190t4n_187">
            CAN_BE_VAL
           </code>
          </p>
         </td>
         <td id="-190t4n_186">
          <p>
           <code class="code" id="-190t4n_188">
            var local = 0
           </code>
           is defined, but never reassigned, can be
           <code class="code" id="-190t4n_189">
            val local = 42
           </code>
           instead
          </p>
         </td>
        </tr>
        <tr id="-190t4n_131">
         <td id="-190t4n_190">
          <p>
           <code class="code" id="-190t4n_192">
            ASSIGNED_VALUE_IS_NEVER_READ
           </code>
          </p>
         </td>
         <td id="-190t4n_191">
          <p>
           <code class="code" id="-190t4n_193">
            val local = 42
           </code>
           is defined, but never used afterward in the code
          </p>
         </td>
        </tr>
        <tr id="-190t4n_132">
         <td id="-190t4n_194">
          <p>
           <code class="code" id="-190t4n_196">
            UNUSED_VARIABLE
           </code>
          </p>
         </td>
         <td id="-190t4n_195">
          <p>
           <code class="code" id="-190t4n_197">
            val local = 0
           </code>
           is defined, but never used in the code
          </p>
         </td>
        </tr>
        <tr id="-190t4n_133">
         <td id="-190t4n_198">
          <p>
           <code class="code" id="-190t4n_200">
            REDUNDANT_RETURN_UNIT_TYPE
           </code>
          </p>
         </td>
         <td id="-190t4n_199">
          <p>
           <code class="code" id="-190t4n_201">
            fun foo(): Unit {}
           </code>
           is used instead of
           <code class="code" id="-190t4n_202">
            fun foo() {}
           </code>
          </p>
         </td>
        </tr>
        <tr id="-190t4n_134">
         <td id="-190t4n_203">
          <p>
           <code class="code" id="-190t4n_205">
            UNREACHABLE_CODE
           </code>
          </p>
         </td>
         <td id="-190t4n_204">
          <p>
           Code statement is present, but can never been executed
          </p>
         </td>
        </tr>
       </tbody>
      </table>
     </div>
     <p id="-190t4n_115">
      If the check is true, you'll receive a compiler warning with a suggestion on how to fix the problem.
     </p>
     <p id="-190t4n_116">
      Extra checks are disabled by default. To enable them, use the
      <code class="code" id="-190t4n_206">
       -Wextra
      </code>
      compiler option in the command line or specify
      <code class="code" id="-190t4n_207">
       extraWarnings
      </code>
      in the
      <code class="code" id="-190t4n_208">
       compilerOptions {}
      </code>
      block of your Gradle build file:
     </p>
     <div class="code-block" data-lang="kotlin">
      kotlin {
    compilerOptions {
        extraWarnings.set(true)
    }
}
     </div>
     <p id="-190t4n_118">
      For more information on how to define and use options, see
      <a data-tooltip="Each release of Kotlin includes compilers for the supported targets: JVM, JavaScript, and native binaries for supported platforms." href="gradle-compiler-options.html" id="-190t4n_209">
       Compiler options in the Kotlin Gradle plugin
      </a>
      .
     </p>
    </section>
    <section class="chapter">
     <h3 data-toc="global-warning-suppression" id="global-warning-suppression">
      Global warning suppression
     </h3>
     <p id="-190t4n_210">
      In 2.1.0-RC2, the Kotlin compiler has received a highly requested feature, the ability to suppress warnings globally.
     </p>
     <p id="-190t4n_211">
      Now you can suppress specific warnings in the whole project. To do that, use the
      <code class="code" id="-190t4n_219">
       -Xsuppress-warning=WARNING_NAME
      </code>
      syntax in the command line or the
      <code class="code" id="-190t4n_220">
       freeCompilerArgs
      </code>
      attribute in the
      <code class="code" id="-190t4n_221">
       compilerOptions {}
      </code>
      block of your build file.
     </p>
     <p id="-190t4n_212">
      For example, if you have
      <a data-tooltip="With Kotlin 2.1.0-RC2, you can now enable additional checks in the K2 compiler. These are extra declaration, expression, and type checks that are usually not crucial for compilation, but can still be useful if you want to validate the following cases:" href="#extra-compiler-checks" id="-190t4n_222">
       extra compiler checks
      </a>
      enabled in your project, but want to suppress one of them, use:
     </p>
     <div class="code-block" data-lang="kotlin">
      kotlin {
    compilerOptions {
        extraWarnings.set(true)
        freeCompilerArgs.add("-Xsuppress-warning=CAN_BE_VAL")
    }
}
     </div>
     <p id="-190t4n_214">
      To get the warning name, select the problematic element and click the light bulb icon (or use
      <kbd class="keystroke" data-bypass="true" id="-190t4n_223">
       <span class="keystroke__value">
        Cmd + Enter
       </span>
      </kbd>
      /
      <kbd class="keystroke" data-bypass="true" id="-190t4n_224">
       <span class="keystroke__value">
        Alt + Enter
       </span>
      </kbd>
      ):
     </p>
     <figure id="-190t4n_215">
      <img alt="Warning name intention" height="299" src="images/warning-name-intention.png" title="Warning name intention" width="500"/>
     </figure>
     <p id="-190t4n_216">
      The new compiler option is currently
      <a data-tooltip="Here's a quick guide to these stability levels and their meaning:" href="components-stability.html#stability-levels-explained" id="-190t4n_225">
       Experimental
      </a>
      . Mind the following nuances:
     </p>
     <ul class="list _bullet" id="-190t4n_217">
      <li class="list__item" id="-190t4n_226">
       <p>
        Error suppression is not allowed.
       </p>
      </li>
      <li class="list__item" id="-190t4n_227">
       <p>
        If you pass an unknown warning name, the compilation will result in an error.
       </p>
      </li>
      <li class="list__item" id="-190t4n_228">
       <p>
        You can also specify several warnings at once:
       </p>
      </li>
     </ul>
     <div class="tabs" data-anchors="[-190t4n_229,-190t4n_230]" id="-190t4n_218">
      <div class="tabs__content" data-gtm="tab" data-title="Command line" id="-190t4n_229">
       <div class="code-block" data-lang="bash" data-title="Bash">
        kotlinc -Xsuppress-warning=NOTHING_TO_INLINE -Xsuppress-warning=NO_TAIL_CALLS_FOUND main.kt
       </div>
      </div>
      <div class="tabs__content" data-gtm="tab" data-title="Build file" id="-190t4n_230">
       <div class="code-block" data-lang="kotlin" data-title="Kotlin">
        kotlin {
    compilerOptions {
        freeCompilerArgs.addAll(
            listOf(
                "-Xsuppress-warning=NOTHING_TO_INLINE",
                "-Xsuppress-warning=NO_TAIL_CALLS_FOUND"
            )
        )
    }
}
       </div>
      </div>
     </div>
    </section>
    <section class="chapter">
     <h3 data-toc="improved-k2-kapt-implementation" id="improved-k2-kapt-implementation">
      Improved K2 kapt implementation
     </h3>
     <aside class="prompt" data-title="" data-type="warning" id="-190t4n_233">
      <p id="-190t4n_242">
       The kapt plugin for the K2 compiler (K2 kapt) is in
       <a data-tooltip="Here's a quick guide to these stability levels and their meaning:" href="components-stability.html#stability-levels-explained" id="-190t4n_243">
        Alpha
       </a>
       . It may be changed at any time. We would appreciate your feedback in
       <a data-external="true" href="https://youtrack.jetbrains.com/issue/KT-71439/K2-kapt-feedback" id="-190t4n_244" rel="noopener noreferrer">
        YouTrack
       </a>
       .
      </p>
     </aside>
     <p id="-190t4n_234">
      Currently, projects using the
      <a data-tooltip="kapt is in maintenance mode. We are keeping it up-to-date with recent Kotlin and Java releases but have no plans to implement new features. Please use the Kotlin Symbol Processing API (KSP) for annotation processing. See the list of libraries supported by KSP." href="kapt.html" id="-190t4n_245">
       kapt
      </a>
      plugin work with the K1 compiler by default, supporting Kotlin versions up to 1.9.
     </p>
     <p id="-190t4n_235">
      In Kotlin 1.9.20, we launched an experimental implementation of the kapt plugin with the K2 compiler (K2 kapt). Now, we improve K2 kapt's internal implementation to mitigate technical and performance issues.
     </p>
     <p id="-190t4n_236">
      While the new K2 kapt implementation doesn't introduce new features, its performance has significantly improved compared to the previous K2 kapt implementation. Additionally, the K2 kapt plugin's behavior is now much closer to K1 kapt.
     </p>
     <p id="-190t4n_237">
      To use the new K2 kapt plugin implementation, enable it the same way as the previous K2 kapt plugin. Add the following flag to the
      <code class="code" id="-190t4n_246">
       gradle.properties
      </code>
      file of your project:
     </p>
     <div class="code-block" data-lang="none">
      kapt.use.k2=true
     </div>
     <p id="-190t4n_239">
      In upcoming releases, the K2 kapt implementation will be enabled by default instead of K1 kapt, so you won't longer need to enable it manually.
     </p>
     <p id="-190t4n_240">
      When using the K2 kapt plugin, you may encounter a compilation error during the
      <code class="code" id="-190t4n_247">
       kaptGenerateStubs*
      </code>
      tasks, even though the actual error details are missing from the Gradle log. This is a
      <a data-external="true" href="https://youtrack.jetbrains.com/issue/KT-71431" id="-190t4n_248" rel="noopener noreferrer">
       known issue
      </a>
      that occurs when kapt is enabled in a module, but no annotation processors are present. The workaround is to disable the kapt plugin in the module.
     </p>
     <p id="-190t4n_241">
      We highly appreciate your
      <a data-external="true" href="https://youtrack.jetbrains.com/issue/KT-71439/K2-kapt-feedback" id="-190t4n_249" rel="noopener noreferrer">
       feedback
      </a>
      before the new implementation is stabilized.
     </p>
    </section>
   </section>
   <section class="chapter">
    <h2 data-toc="kotlin-multiplatform" id="kotlin-multiplatform">
     Kotlin Multiplatform
    </h2>
    <p id="-190t4n_250">
     Kotlin 2.1.0-RC2 focuses on the improvements around Gradle: stabilizes new DSL for configuring compiler options in multiplatform projects and introduces a preview of Isolated Projects feature.
    </p>
    <section class="chapter">
     <h3 data-toc="new-gradle-dsl-for-compiler-options-in-multiplatform-projects-is-stable" id="new-gradle-dsl-for-compiler-options-in-multiplatform-projects-is-stable">
      New Gradle DSL for compiler options in multiplatform projects is stable
     </h3>
     <p id="-190t4n_253">
      In Kotlin 2.0.0,
      <a data-tooltip="This feature is Experimental. It may be dropped or changed at any time. Use it only for evaluation purposes. We would appreciate your feedback on it in YouTrack." href="whatsnew20.html#new-gradle-dsl-for-compiler-options-in-multiplatform-projects" id="-190t4n_263">
       we introduced a new Experimental Gradle DSL
      </a>
      to simplify the configuration of compiler options across your multiplatform projects. In Kotlin 2.1.0-RC2, this DSL has been promoted to Stable.
     </p>
     <p id="-190t4n_254">
      With this new DSL, you can configure compiler options at the extension level for all targets and shared source sets like
      <code class="code" id="-190t4n_264">
       commonMain
      </code>
      , as well as at the target level for specific targets:
     </p>
     <div class="code-block" data-lang="kotlin">
      kotlin {
    compilerOptions {
        // Extension-level common compiler options that are used as defaults
        // for all targets and shared source sets
        allWarningsAsErrors.set(true)
    }
    jvm {
        compilerOptions {
            // Target-level JVM compiler options that are used as defaults
            // for all compilations in this target
            noJdk.set(true)
        }
    }
}
     </div>
     <p id="-190t4n_256">
      The overall project configuration now has three layers. The highest is the extension level, then the target level, and the lowest is the compilation unit (which is usually a compilation task):
     </p>
     <figure id="-190t4n_257">
      <img alt="Kotlin compiler options levels" height="440" src="images/compiler-options-levels.svg" title="Kotlin compiler options levels" width="700"/>
     </figure>
     <p id="-190t4n_258">
      The settings at a higher level are used as a convention (default) for a lower level:
     </p>
     <ul class="list _bullet" id="-190t4n_259">
      <li class="list__item" id="-190t4n_265">
       <p>
        The values of extension compiler options are the default for target compiler options, including shared source sets, like
        <code class="code" id="-190t4n_267">
         commonMain
        </code>
        ,
        <code class="code" id="-190t4n_268">
         nativeMain
        </code>
        , and
        <code class="code" id="-190t4n_269">
         commonTest
        </code>
        .
       </p>
      </li>
      <li class="list__item" id="-190t4n_266">
       <p>
        The values of target compiler options are used as the default for compilation unit (task) compiler options, for example,
        <code class="code" id="-190t4n_270">
         compileKotlinJvm
        </code>
        and
        <code class="code" id="-190t4n_271">
         compileTestKotlinJvm
        </code>
        tasks.
       </p>
      </li>
     </ul>
     <p id="-190t4n_260">
      In turn, configurations made at a lower level override related settings at a higher level:
     </p>
     <ul class="list _bullet" id="-190t4n_261">
      <li class="list__item" id="-190t4n_272">
       <p>
        Task-level compiler options override related configurations at the target or the extension level.
       </p>
      </li>
      <li class="list__item" id="-190t4n_273">
       <p>
        Target-level compiler options override related configurations at the extension level.
       </p>
      </li>
     </ul>
     <p id="-190t4n_262">
      When configuring your project, keep in mind that some old ways of setting up compiler options have been
      <a data-tooltip="In this release, we continue to refine how you can set up compiler options. It should resolve ambiguity between different ways and make the project configuration more straightforward." href="whatsnew20.html#deprecated-old-ways-of-defining-compiler-options" id="-190t4n_274">
       deprecated
      </a>
      .
     </p>
    </section>
    <section class="chapter">
     <h3 data-toc="preview-gradle-s-isolated-projects-in-kotlin-multiplatform" id="preview-gradle-s-isolated-projects-in-kotlin-multiplatform">
      Preview Gradle's Isolated Projects in Kotlin Multiplatform
     </h3>
     <aside class="prompt" data-title="" data-type="warning" id="-190t4n_275">
      <p id="-190t4n_280">
       This feature is
       <a data-tooltip="Here's a quick guide to these stability levels and their meaning:" href="components-stability.html#stability-levels-explained" id="-190t4n_281">
        Experimental
       </a>
       and is currently in a pre-alpha state with Gradle. Use it only with Gradle version 8.10 and solely for evaluation purposes. The feature may be dropped or changed at any time. We would appreciate your feedback on it in
       <a data-external="true" href="https://youtrack.jetbrains.com/issue/KT-57279/Support-Gradle-Project-Isolation-Feature-for-Kotlin-Multiplatform" id="-190t4n_282" rel="noopener noreferrer">
        YouTrack
       </a>
       . Opt-in is required (see details below).
      </p>
     </aside>
     <p id="-190t4n_276">
      In Kotlin 2.1.0-RC2, you can preview Gradle's
      <a data-external="true" href="https://docs.gradle.org/current/userguide/isolated_projects.html" id="-190t4n_283" rel="noopener noreferrer">
       Isolated Projects
      </a>
      feature in your multiplatform projects.
     </p>
     <p id="-190t4n_277">
      The Isolated Projects feature in Gradle improves build performance by "isolating" individual Gradle projects from each other. Each project's build logic is restricted from directly accessing the mutable state of other projects, allowing them to safely run in parallel. To support this feature, we made some changes to the Kotlin Gradle plugin's model, and we are interested in hearing about your experiences during this preview phase.
     </p>
     <p id="-190t4n_278">
      There are two ways to enable the Kotlin Gradle plugin's new model:
     </p>
     <ul class="list _bullet" id="-190t4n_279">
      <li class="list__item" id="-190t4n_284">
       <p id="-190t4n_286">
        Option 1:
        <span class="control" id="-190t4n_288">
         Testing compatibility without enabling Isolated Projects
        </span>
        : To check compatibility with the Kotlin Gradle plugin's new model without enabling the Isolated Projects feature, add the following Gradle property in the
        <code class="code" id="-190t4n_289">
         gradle.properties
        </code>
        file of your project:
       </p>
       <div class="code-block" data-lang="none">
        kotlin.kmp.isolated-projects.support=enable
       </div>
      </li>
      <li class="list__item" id="-190t4n_285">
       <p id="-190t4n_290">
        Option 2:
        <span class="control" id="-190t4n_291">
         Testing with Isolated Projects enabled
        </span>
        : Enabling the Isolated Projects feature in Gradle automatically configures the Kotlin Gradle plugin to use the new model. To enable the Isolated Projects feature,
        <a data-external="true" href="https://docs.gradle.org/current/userguide/isolated_projects.html#how_do_i_use_it" id="-190t4n_292" rel="noopener noreferrer">
         set the system property
        </a>
        . In this case, you don't need to add the Gradle property for the Kotlin Gradle plugin to your project.
       </p>
      </li>
     </ul>
    </section>
   </section>
   <section class="chapter">
    <h2 data-toc="kotlin-native" id="kotlin-native">
     Kotlin/Native
    </h2>
    <p id="-190t4n_293">
     Kotlin 2.1.0-RC2 includes an upgrade for the
     <code class="code" id="-190t4n_297">
      iosArm64
     </code>
     target support, improved cinterop caching process, and other updates.
    </p>
    <section class="chapter">
     <h3 data-toc="iosarm64-is-promoted-to-tier-1" id="iosarm64-is-promoted-to-tier-1">
      iosArm64 is promoted to Tier 1
     </h3>
     <p id="-190t4n_298">
      The
      <code class="code" id="-190t4n_301">
       iosArm64
      </code>
      target, which is crucial for
      <a data-tooltip="Support for multiplatform programming is one of Kotlin's key benefits. It reduces time spent writing and maintaining the same code for different platforms while retaining the flexibility and benefits of native programming." href="multiplatform-intro.html" id="-190t4n_302">
       Kotlin Multiplatform
      </a>
      development, has been promoted to Tier 1. It's the highest level of support in the Kotlin/Native compiler.
     </p>
     <p id="-190t4n_299">
      This means the target is regularly tested on CI to ensure that it's able to compile and run. We also provide source and binary compatibility between compiler releases for it.
     </p>
     <p id="-190t4n_300">
      For more information on target tiers, see
      <a data-tooltip="The Kotlin/Native compiler supports a great number of different targets, though it is hard to provide the same level of support for all of them. This document describes which targets Kotlin/Native supports and breaks them into several tiers depending on how well the compiler…" href="native-target-support.html" id="-190t4n_303">
       Kotlin/Native target support
      </a>
      .
     </p>
    </section>
    <section class="chapter">
     <h3 data-toc="llvm-update-from-11-1-0-to-16-0-0" id="llvm-update-from-11-1-0-to-16-0-0">
      LLVM update from 11.1.0 to 16.0.0
     </h3>
     <p id="-190t4n_304">
      In Kotlin 2.1.0-RC2, we updated LLVM from version 11.1.0 to 16.0.0. The new version includes LLVM bug fixes and security updates. In certain cases, it also brings compiler optimizations and faster compilation.
     </p>
     <p id="-190t4n_305">
      If you have Linux targets in your project, mind that the Kotlin/Native compiler now uses the
      <code class="code" id="-190t4n_307">
       lld
      </code>
      linker by default for all Linux targets.
     </p>
     <p id="-190t4n_306">
      This update shouldn't affect your code, but if you encounter any issues, please report them to our
      <a data-external="true" href="http://kotl.in/issue" id="-190t4n_308" rel="noopener noreferrer">
       issue tracker
      </a>
      .
     </p>
    </section>
    <section class="chapter">
     <h3 data-toc="changes-to-caching-in-cinterop" id="changes-to-caching-in-cinterop">
      Changes to caching in cinterop
     </h3>
     <p id="-190t4n_309">
      In Kotlin 2.1.0-RC2, we're making changes to the cinterop caching process. It no longer has the
      <a data-external="true" href="https://docs.gradle.org/current/javadoc/org/gradle/api/tasks/CacheableTask.html" id="-190t4n_311" rel="noopener noreferrer">
       <code class="code" id="-190t4n_313">
        CacheableTask
       </code>
      </a>
      annotation type. The recommended approach now is to use the
      <a data-external="true" href="https://docs.gradle.org/current/kotlin-dsl/gradle/org.gradle.api.tasks/-task-outputs/cache-if.html" id="-190t4n_312" rel="noopener noreferrer">
       <code class="code" id="-190t4n_314">
        cacheIf
       </code>
      </a>
      output type to cache the results of the task.
     </p>
     <p id="-190t4n_310">
      This should fix the issue when changes to header files specified in the
      <a data-tooltip="Kotlin/Native enables you to consume C and Objective-C libraries, allowing you to use their functionality in Kotlin. A special tool called cinterop takes a C or an Objective-C library and generates the corresponding Kotlin bindings, so that the library's methods can be used in your…" href="native-definition-file.html" id="-190t4n_315">
       definition file
      </a>
      were not recognized by UP-TO-DATE checks, so the build system failed to recompile the code.
     </p>
    </section>
   </section>
   <section class="chapter">
    <h2 data-toc="kotlin-wasm" id="kotlin-wasm">
     Kotlin/Wasm
    </h2>
    <section class="chapter">
     <h3 data-toc="support-for-incremental-compilation" id="support-for-incremental-compilation">
      Support for incremental compilation
     </h3>
     <p id="-190t4n_323">
      Previously, when you changed something to your Kotlin code, the Kotlin/Wasm toolchain had to recompile the entire codebase.
     </p>
     <p id="-190t4n_324">
      Starting from 2.1.0-RC2, incremental compilation is supported for the Wasm targets. In development tasks, the compiler now recompiles only files relevant to changes from the last compilation, which noticeably reduces the compilation time.
     </p>
     <p id="-190t4n_325">
      This change doubles the development speed for now, with plans to improve it further in future releases.
     </p>
     <p id="-190t4n_326">
      In the current setup, incremental compilation for the Wasm targets is disabled by default. To enable incremental compilation, add the following line to your project's
      <code class="code" id="-190t4n_329">
       local.properties
      </code>
      or
      <code class="code" id="-190t4n_330">
       gradle.properties
      </code>
      file:
     </p>
     <div class="code-block" data-lang="none">
      kotlin.incremental.wasm=true
     </div>
     <p id="-190t4n_328">
      Try out the Kotlin/Wasm incremental compilation and
      <a data-external="true" href="https://youtrack.jetbrains.com/issue/KT-72158/Kotlin-Wasm-incremental-compilation-feedback" id="-190t4n_331" rel="noopener noreferrer">
       share your feedback
      </a>
      ! Your insights will help make this feature stable and default sooner.
     </p>
    </section>
    <section class="chapter">
     <h3 data-toc="browser-apis-moved-to-the-kotlinx-browser-stand-alone-library" id="browser-apis-moved-to-the-kotlinx-browser-stand-alone-library">
      Browser APIs moved to the kotlinx-browser stand-alone library
     </h3>
     <p id="-190t4n_332">
      Before, the declarations for Web APIs and related target utilities were part of the Kotlin/Wasm standard library.
     </p>
     <p id="-190t4n_333">
      In this release, the
      <code class="code" id="-190t4n_337">
       org.w3c.*
      </code>
      declarations have been moved from the Kotlin/Wasm standard library to the new
      <a data-external="true" href="https://github.com/kotlin/kotlinx-browser" id="-190t4n_338" rel="noopener noreferrer">
       kotlinx-browser library
      </a>
      . This library also includes other web-related packages, such as
      <code class="code" id="-190t4n_339">
       org.khronos.webgl
      </code>
      ,
      <code class="code" id="-190t4n_340">
       kotlin.dom
      </code>
      , and
      <code class="code" id="-190t4n_341">
       kotlin.browser
      </code>
      .
     </p>
     <p id="-190t4n_334">
      This separation provides modularity, enabling independent updates for web-related APIs outside of Kotlin's release cycle. Additionally, the Kotlin/Wasm standard library now contains only declarations available in any JavaScript environments.
     </p>
     <p id="-190t4n_335">
      To use the declarations from the moved packages, you need to add the
      <code class="code" id="-190t4n_342">
       kotlinx-browser
      </code>
      dependency in your project's build configuration file:
     </p>
     <div class="code-block" data-lang="kotlin">
      val wasmJsMain by getting {
    dependencies {
        implementation("org.jetbrains.kotlinx:kotlinx-browser:0.2")
    }
}
     </div>
    </section>
    <section class="chapter">
     <h3 data-toc="improved-debugging-experience-for-kotlin-wasm" id="improved-debugging-experience-for-kotlin-wasm">
      Improved debugging experience for Kotlin/Wasm
     </h3>
     <p id="-190t4n_343">
      Previously, when debugging Kotlin/Wasm code in web browsers, you might encounter a low-level representation of variable values in the debugging interface. This often made it challenging to track the current state of the application.
     </p>
     <figure id="-190t4n_344">
      <img alt="Kotlin/Wasm old debugger" height="445" src="images/wasm-old-debugger.png" title="Kotlin/Wasm old debugger" width="700"/>
     </figure>
     <p id="-190t4n_345">
      To improve this experience, custom formatters have been added in the variable view. The implementation uses the
      <a data-external="true" href="https://firefox-source-docs.mozilla.org/devtools-user/custom_formatters/index.html" id="-190t4n_350" rel="noopener noreferrer">
       custom formatters API
      </a>
      , which is supported across major browsers like Firefox and Chromium-based.
     </p>
     <p id="-190t4n_346">
      With this change, you can now display and locate variable values in a more user-friendly and comprehensible manner.
     </p>
     <figure id="-190t4n_347">
      <img alt="Kotlin/Wasm improved debugger" height="495" src="images/wasm-debugger-improved.png" title="Kotlin/Wasm improved debugger" width="700"/>
     </figure>
     <p id="-190t4n_348">
      To try the new debugging experience:
     </p>
     <ol class="list _decimal" id="-190t4n_349" type="1">
      <li class="list__item" id="-190t4n_351">
       <p id="-190t4n_353">
        Add the following compiler argument to the
        <code class="code" id="-190t4n_355">
         wasmJs
        </code>
        compiler options:
       </p>
       <div class="code-block" data-lang="kotlin">
        kotlin {
    wasmJs {
        …
        compilerOptions {
            freeCompilerArgs.add("-Xwasm-debugger-custom-formatters")
        }
    }
}
       </div>
      </li>
      <li class="list__item" id="-190t4n_352">
       <p id="-190t4n_356">
        Enable the
        <span class="control" id="-190t4n_361">
         Custom formatters
        </span>
        feature in your browser.
       </p>
       <p id="-190t4n_357">
        In the Chrome DevTools, it's placed in
        <span class="control" id="-190t4n_362">
         Settings | Preferences | Console
        </span>
        :
       </p>
       <figure id="-190t4n_358">
        <img alt="Enable custom formatters in Chrome" height="718" src="images/wasm-custom-formatters-chrome.png" title="Enable custom formatters in Chrome" width="700"/>
       </figure>
       <p id="-190t4n_359">
        In the Firefox Developer Tools, it's placed in
        <span class="control" id="-190t4n_363">
         Settings | Advanced settings
        </span>
        :
       </p>
       <figure id="-190t4n_360">
        <img alt="Enable custom formatters in Firefox" height="541" src="images/wasm-custom-formatters-firefox.png" title="Enable custom formatters in Firefox" width="700"/>
       </figure>
      </li>
     </ol>
    </section>
    <section class="chapter">
     <h3 data-toc="reduced-size-of-kotlin-wasm-binaries" id="reduced-size-of-kotlin-wasm-binaries">
      Reduced size of Kotlin/Wasm binaries
     </h3>
     <p id="-190t4n_364">
      The size of your Wasm binaries produced by production builds will be reduced by up to 30%, and you may see some performance improvements. This is due to the fact that Binaryen options
      <code class="code" id="-190t4n_365">
       --closed-world
      </code>
      ,
      <code class="code" id="-190t4n_366">
       --type-ssa
      </code>
      , and
      <code class="code" id="-190t4n_367">
       --type-merging
      </code>
      are now considered safe to use for all Kotlin/Wasm projects and are enabled by default.
     </p>
    </section>
    <section class="chapter">
     <h3 data-toc="improved-javascript-array-interoperability-in-kotlin-wasm" id="improved-javascript-array-interoperability-in-kotlin-wasm">
      Improved JavaScript array interoperability in Kotlin/Wasm
     </h3>
     <p id="-190t4n_368">
      While Kotlin/Wasm's standard library provides the
      <code class="code" id="-190t4n_376">
       JsArray&lt;T&gt;
      </code>
      type for JavaScript arrays, there was no direct method to transform
      <code class="code" id="-190t4n_377">
       JsArray&lt;T&gt;
      </code>
      into Kotlin's native
      <code class="code" id="-190t4n_378">
       Array
      </code>
      or
      <code class="code" id="-190t4n_379">
       List
      </code>
      types.
     </p>
     <p id="-190t4n_369">
      This gap required creating custom functions for array transformations, complicating interoperability between Kotlin and JavaScript code.
     </p>
     <p id="-190t4n_370">
      This release introduces an adapter function that automatically converts
      <code class="code" id="-190t4n_380">
       JsArray&lt;T&gt;
      </code>
      to
      <code class="code" id="-190t4n_381">
       Array&lt;T&gt;
      </code>
      and vice versa, simplifying array operations.
     </p>
     <p id="-190t4n_371">
      Here's an example of conversion between generic types: Kotlin
      <code class="code" id="-190t4n_382">
       List&lt;T&gt;
      </code>
      and
      <code class="code" id="-190t4n_383">
       Array&lt;T&gt;
      </code>
      to JavaScript
      <code class="code" id="-190t4n_384">
       JsArray&lt;T&gt;.
      </code>
     </p>
     <div class="code-block" data-lang="kotlin">
      val list: List&lt;JsString&gt; =
    listOf("Kotlin", "Wasm").map { it.toJsString() }

// Uses .toJsArray() to convert List or Array to JsArray
val jsArray: JsArray&lt;JsString&gt; = list.toJsArray()

// Uses .toArray() and .toList() to convert it back to Kotlin types 
val kotlinArray: Array&lt;JsString&gt; = jsArray.toArray()
val kotlinList: List&lt;JsString&gt; = jsArray.toList()
     </div>
     <p id="-190t4n_373">
      Similar methods are available for converting typed arrays to their Kotlin equivalents (for example,
      <code class="code" id="-190t4n_385">
       IntArray
      </code>
      and
      <code class="code" id="-190t4n_386">
       Int32Array
      </code>
      ). For detailed information and implementation, see the
      <a data-external="true" href="https://github.com/Kotlin/kotlinx-browser/blob/dfbdceed314567983c98f1d66e8c2e10d99c5a55/src/wasmJsMain/kotlin/arrayCopy.kt" id="-190t4n_387" rel="noopener noreferrer">
       <code class="code" id="-190t4n_388">
        kotlinx-browser
       </code>
       repository
      </a>
      .
     </p>
     <p id="-190t4n_374">
      Here's an example of conversion between typed arrays: Kotlin
      <code class="code" id="-190t4n_389">
       IntArray
      </code>
      to JavaScript
      <code class="code" id="-190t4n_390">
       Int32Array
      </code>
      .
     </p>
     <div class="code-block" data-lang="kotlin">
      import org.khronos.webgl.*

    // ...

    val intArray: IntArray = intArrayOf(1, 2, 3)
    
    // Uses .toInt32Array() to convert Kotlin IntArray to JavaScript Int32Array
    val jsInt32Array: Int32Array = intArray.toInt32Array()
    
    // Uses toIntArray() to convert JavaScript Int32Array back to Kotlin IntArray
    val kotlnIntArray: IntArray = jsInt32Array.toIntArray()
     </div>
    </section>
    <section class="chapter">
     <h3 data-toc="support-for-accessing-javascript-exception-details-in-kotlin-wasm" id="support-for-accessing-javascript-exception-details-in-kotlin-wasm">
      Support for accessing JavaScript exception details in Kotlin/Wasm
     </h3>
     <p id="-190t4n_391">
      Previously, when a JavaScript exception occurred in Kotlin/Wasm, the
      <code class="code" id="-190t4n_400">
       JsException
      </code>
      type provided only a generic message without details from the original JavaScript error.
     </p>
     <p id="-190t4n_392">
      Starting from Kotlin 2.1.0-RC2, you can now configure
      <code class="code" id="-190t4n_401">
       JsException
      </code>
      to include the original error message and stack trace by enabling a specific compiler flag, providing more context to help diagnose issues originating from JavaScript.
     </p>
     <p id="-190t4n_393">
      This behavior depends on the
      <code class="code" id="-190t4n_402">
       WebAssembly.JSTag
      </code>
      API, which is available only in certain browsers:
     </p>
     <ul class="list _bullet" id="-190t4n_394">
      <li class="list__item" id="-190t4n_403">
       <p>
        <span class="control" id="-190t4n_406">
         Chrome
        </span>
        : Supported from version 115
       </p>
      </li>
      <li class="list__item" id="-190t4n_404">
       <p>
        <span class="control" id="-190t4n_407">
         Firefox
        </span>
        : Supported from version 129
       </p>
      </li>
      <li class="list__item" id="-190t4n_405">
       <p>
        <span class="control" id="-190t4n_408">
         Safari
        </span>
        : Not yet supported
       </p>
      </li>
     </ul>
     <p id="-190t4n_395">
      This feature is disabled by default. To enable this feature, add the following compiler flag to your
      <code class="code" id="-190t4n_409">
       build.gradle.kts
      </code>
      file:
     </p>
     <div class="code-block" data-lang="kotlin">
      kotlin {
    wasmJs {
        compilerOptions {
            freeCompilerArgs.add("-Xwasm-attach-js-exception")
        }
    }
}
     </div>
     <p id="-190t4n_397">
      Here’s an example demonstrating the new behavior:
     </p>
     <div class="code-block" data-lang="kotlin">
      external object JSON {
    fun &lt;T: JsAny&gt; parse(json: String): T
}

fun main() {
    try {
        JSON.parse("an invalid JSON")
    } catch (e: JsException) {
        println("Thrown value is: ${e.thrownValue}")
        // SyntaxError: Unexpected token 'a', "an invalid JSON" is not valid JSON

        println("Message: ${e.message}")
        // Message: Unexpected token 'a', "an invalid JSON" is not valid JSON

        println("Stacktrace:")
        // Stacktrace:

        // Prints the full JavaScript stack trace 
        e.printStackTrace()
    }
}
     </div>
     <p id="-190t4n_399">
      With the
      <code class="code" id="-190t4n_410">
       -Xwasm-attach-js-exception
      </code>
      flag enabled,
      <code class="code" id="-190t4n_411">
       JsException
      </code>
      provides specific details from the JavaScript error. Without the flag,
      <code class="code" id="-190t4n_412">
       JsException
      </code>
      includes only a generic message stating that an exception was thrown while running JavaScript code.
     </p>
    </section>
    <section class="chapter">
     <h3 data-toc="deprecation-of-default-exports" id="deprecation-of-default-exports">
      Deprecation of default exports
     </h3>
     <p id="-190t4n_413">
      As part of the migration towards named exports, an error was previously printed to the console when using a default import for Kotlin/Wasm exports in JavaScript.
     </p>
     <p id="-190t4n_414">
      In 2.1.0-RC2, default imports are completely removed in order to fully support named exports.
     </p>
     <p id="-190t4n_415">
      When coding in JavaScript for the Kotlin/Wasm target, you now need to use the corresponding named imports instead of default imports.
     </p>
     <p id="-190t4n_416">
      This change marks the last phase of a deprecation cycle to migrate towards named exports:
     </p>
     <p id="-190t4n_417">
      <span class="control" id="-190t4n_420">
       In version 2.0.0:
      </span>
      A warning message was printed to the console, explaining that exporting entities via default exports is deprecated.
     </p>
     <p id="-190t4n_418">
      <span class="control" id="-190t4n_421">
       In version 2.0.20:
      </span>
      An error occurred, requesting the use of the corresponding named import.
     </p>
     <p id="-190t4n_419">
      <span class="control" id="-190t4n_422">
       In version 2.1.0:
      </span>
      The use of default imports is completely removed.
     </p>
    </section>
   </section>
   <section class="chapter">
    <h2 data-toc="support-for-non-identifier-characters-in-kotlin-js-properties" id="support-for-non-identifier-characters-in-kotlin-js-properties">
     Support for non-identifier characters in Kotlin/JS properties
    </h2>
    <p id="-190t4n_423">
     Kotlin/JS previously did not allow using
     <a data-tooltip="In tests (and only in tests), you can use method names with spaces enclosed in backticks. Note that such method names are only supported by Android runtime from API level 30. Underscores in method names are also allowed in test code." href="coding-conventions.html#names-for-test-methods" id="-190t4n_430">
      names for test methods
     </a>
     with spaces enclosed in backticks.
    </p>
    <p id="-190t4n_424">
     Similarly, it was not possible to access JavaScript object properties that contained characters not permitted in Kotlin identifiers, such as hyphens or spaces:
    </p>
    <div class="code-block" data-lang="kotlin">
     external interface Headers {
    var accept: String?

    // Invalid Kotlin identifier due to hyphen
    var `content-length`: String?
}

val headers: Headers = TODO("value provided by a JS library")
val accept = headers.accept
// Causes error due to the hyphen in property name
val length = headers.`content-length`
    </div>
    <p id="-190t4n_426">
     This behavior differed from JavaScript and TypeScript, which allow such properties to be accessed using non-identifier characters.
    </p>
    <p id="-190t4n_427">
     Starting from Kotlin 2.1.0-RC2, this feature is enabled by default. Kotlin/JS now allows you to use the backquote syntax and the
     <code class="code" id="-190t4n_431">
      @JsName
     </code>
     annotation to interact with JavaScript properties that contain non-identifier characters and to use names for test methods.
    </p>
    <p id="-190t4n_428">
     Now, you can enclose property names in backticks (``) to reference non-identifier characters. Additionally, you can use the
     <code class="code" id="-190t4n_432">
      @JsName
     </code>
     and
     <code class="code" id="-190t4n_433">
      @JsQualifier
     </code>
     annotations to map Kotlin property names to JavaScript equivalents:
    </p>
    <div class="code-block" data-lang="kotlin">
     object Bar {
    val `property example`: String = "bar"
}

@JsQualifier("fooNamespace")
external object Foo {
    val `property example`: String
}

@JsExport
object Baz {
    val `property example`: String = "bar"
}

fun main() {
    // In JS, this is compiled into Bar.property_example_HASH
    println(Bar.`property example`)
    // In JS, this is compiled into fooNamespace["property example"]
    println(Foo.`property example`)
    // In JS, this is compiled into Baz["property example"]
    println(Baz.`property example`)
}
    </div>
   </section>
   <section class="chapter">
    <h2 data-toc="gradle-improvements" id="gradle-improvements">
     Gradle improvements
    </h2>
    <p id="-190t4n_434">
     Kotlin 2.1.0-RC2 is fully compatible with Gradle 7.6.3 through 8.6. Gradle versions 8.7 to 8.10 are also supported, with only one exception: If you use the Kotlin Multiplatform Gradle plugin, you may see deprecation warnings in your multiplatform projects calling the
     <a data-tooltip="In addition to common target configuration, jvm targets have a specific function:" href="multiplatform-dsl-reference.html#jvm-targets" id="-190t4n_439">
      <code class="code" id="-190t4n_440">
       withJava()
      </code>
      function in the JVM target
     </a>
     . We plan to fix this issue as soon as possible.
    </p>
    <p id="-190t4n_435">
     For more information, see the issue in
     <a data-external="true" href="https://youtrack.jetbrains.com/issue/KT-66542/Gradle-JVM-target-with-withJava-produces-a-deprecation-warning" id="-190t4n_441" rel="noopener noreferrer">
      YouTrack
     </a>
     .
    </p>
    <p id="-190t4n_436">
     You can also use Gradle versions up to the latest Gradle release, but if you do, keep in mind that you may encounter deprecation warnings or some new Gradle features might not work.
    </p>
    <section class="chapter">
     <h3 data-toc="bumped-the-minimum-supported-agp-version-to-7-3-1" id="bumped-the-minimum-supported-agp-version-to-7-3-1">
      Bumped the minimum supported AGP version to 7.3.1
     </h3>
     <p id="-190t4n_442">
      Starting with Kotlin 2.1.0-RC2, the minimum supported Android Gradle plugin version is 7.3.1.
     </p>
    </section>
    <section class="chapter">
     <h3 data-toc="bumped-the-minimum-supported-gradle-version-to-7-6-3" id="bumped-the-minimum-supported-gradle-version-to-7-6-3">
      Bumped the minimum supported Gradle version to 7.6.3
     </h3>
     <p id="-190t4n_443">
      Starting with Kotlin 2.1.0-RC2, the minimum supported Gradle version is 7.6.3.
     </p>
    </section>
   </section>
   <section class="chapter">
    <h2 data-toc="compose-compiler-updates" id="compose-compiler-updates">
     Compose compiler updates
    </h2>
    <section class="chapter">
     <h3 data-toc="support-for-multiple-stability-configuration-files" id="support-for-multiple-stability-configuration-files">
      Support for multiple stability configuration files
     </h3>
     <p id="-190t4n_445">
      Compose compiler is able to interpret multiple stability configuration files, but the
      <code class="code" id="-190t4n_450">
       stabilityConfigurationFile
      </code>
      option of the Compose Compiler Gradle plugin is only allowed for a single file to be specified.
     </p>
     <p id="-190t4n_446">
      In Kotlin 2.1.0-RC2, this functionality was reworked to allow you to use several stability configuration files for a single module:
     </p>
     <ul class="list _bullet" id="-190t4n_447">
      <li class="list__item" id="-190t4n_451">
       <p>
        The
        <code class="code" id="-190t4n_453">
         stabilityConfigurationFile
        </code>
        option is deprecated.
       </p>
      </li>
      <li class="list__item" id="-190t4n_452">
       <p>
        There is a new option,
        <code class="code" id="-190t4n_454">
         stabilityConfigurationFiles
        </code>
        with the type
        <code class="code" id="-190t4n_455">
         ListProperty&lt;RegularFile&gt;
        </code>
        .
       </p>
      </li>
     </ul>
     <p id="-190t4n_448">
      Here's how you can pass several files to the Compose compiler using the new option:
     </p>
     <div class="code-block" data-lang="kotlin">
      composeCompiler {
    stabilityConfigurationFiles.addAll(
        project.layout.projectDirectory.file("configuration-file1.conf"),
        project.layout.projectDirectory.file("configuration-file2.conf"),
    )
}
     </div>
    </section>
   </section>
   <section class="chapter">
    <h2 data-toc="how-to-update-to-kotlin-kotlineapversion" id="how-to-update-to-kotlin-kotlineapversion">
     How to update to Kotlin 2.1.0-RC2
    </h2>
    <p id="-190t4n_456">
     Starting from IntelliJ IDEA 2023.3 and Android Studio Iguana (2023.2.1) Canary 15, the Kotlin plugin is distributed as a bundled plugin included in your IDE. This means that you can't install the plugin from JetBrains Marketplace anymore. The bundled plugin supports upcoming Kotlin EAP releases.
    </p>
    <p id="-190t4n_457">
     To update to the new Kotlin EAP version,
     <a data-tooltip="In the plugins block within build.gradle(.kts), change the KOTLIN-EAP-VERSION to the actual EAP version, such as 2.1.0-RC2. Available EAP versions are listed here." href="configure-build-for-eap.html#adjust-the-kotlin-version" id="-190t4n_458">
      change the Kotlin version
     </a>
     to 2.1.0-RC2 in your build scripts.
    </p>
   </section>
   <div class="last-modified">
    Last modified: 16 December 2024
   </div>
   <div data-feedback-placeholder="true">
   </div>
  </div>
 </body>
</html>
