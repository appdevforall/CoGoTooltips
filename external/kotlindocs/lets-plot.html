<html>
 <head>
  <meta charset="utf-8"/>
  <link href="doc_style.css" rel="stylesheet"/>
 </head>
 <body>
  <a class="menu-link" href="toc.html">
   MENU
  </a>
  <hr/>
  <div class="article-content">
   <h1 data-toc="lets-plot" id="lets-plot.md">
    Data visualization with Lets-Plot for Kotlin
   </h1>
   <p id="tb7jv7_2">
    <a data-external="true" href="https://lets-plot.org/kotlin/get-started.html" id="tb7jv7_12" rel="noopener noreferrer">
     Lets-Plot for Kotlin (LPK)
    </a>
    is a multiplatform plotting library that ports the
    <a data-external="true" href="https://ggplot2.tidyverse.org/" id="tb7jv7_13" rel="noopener noreferrer">
     R's ggplot2 library
    </a>
    to Kotlin. LPK brings the feature-rich ggplot2 API to the Kotlin ecosystem, making it suitable for scientists and statisticians who require sophisticated data visualization capabilities.
   </p>
   <p id="tb7jv7_3">
    LPK targets various platforms, including
    <a data-tooltip="Notebooks are interactive editors that integrate code, graphics, and text in a single environment. When using a notebook, you can run code cells and immediately see the output." href="data-analysis-overview.html#notebooks" id="tb7jv7_14">
     Kotlin notebooks
    </a>
    ,
    <a data-tooltip="Kotlin/JS provides the ability to transpile your Kotlin code, the Kotlin standard library, and any compatible dependencies to JavaScript. The current implementation of Kotlin/JS targets ES5." href="js-overview.html" id="tb7jv7_15">
     Kotlin/JS
    </a>
    ,
    <a data-external="true" href="https://docs.oracle.com/javase/8/docs/technotes/guides/swing/" id="tb7jv7_16" rel="noopener noreferrer">
     JVM's Swing
    </a>
    ,
    <a data-external="true" href="https://openjfx.io/" id="tb7jv7_17" rel="noopener noreferrer">
     JavaFX
    </a>
    , and
    <a data-external="true" href="https://www.jetbrains.com/lp/compose-multiplatform/" id="tb7jv7_18" rel="noopener noreferrer">
     Compose Multiplatform
    </a>
    . Additionally, LPK has seamless integration with
    <a data-external="true" href="https://www.jetbrains.com/idea/" id="tb7jv7_19" rel="noopener noreferrer">
     IntelliJ
    </a>
    ,
    <a data-external="true" href="https://www.jetbrains.com/datagrip/" id="tb7jv7_20" rel="noopener noreferrer">
     DataGrip
    </a>
    ,
    <a data-external="true" href="https://www.jetbrains.com/dataspell/" id="tb7jv7_21" rel="noopener noreferrer">
     DataSpell
    </a>
    , and
    <a data-external="true" href="https://www.jetbrains.com/pycharm/" id="tb7jv7_22" rel="noopener noreferrer">
     PyCharm
    </a>
    .
   </p>
   <figure id="tb7jv7_4">
    <img alt="Lets-Plot" height="485" src="images/lets-plot-overview.png" title="Lets-Plot" width="700"/>
   </figure>
   <p id="tb7jv7_5">
    This tutorial demonstrates how to create different plot types with the LPK and
    <a data-external="true" href="https://kotlin.github.io/dataframe/gettingstarted.html" id="tb7jv7_23" rel="noopener noreferrer">
     Kotlin DataFrame
    </a>
    libraries using Kotlin Notebook in IntelliJ IDEA.
   </p>
   <section class="chapter">
    <h2 data-toc="before-you-start" id="before-you-start">
     Before you start
    </h2>
    <ol class="list _decimal" id="tb7jv7_24" type="1">
     <li class="list__item" id="tb7jv7_25">
      <p id="tb7jv7_29">
       Download and install the latest version of
       <a data-external="true" href="https://www.jetbrains.com/idea/download/?section=mac" id="tb7jv7_30" rel="noopener noreferrer">
        IntelliJ IDEA Ultimate
       </a>
       .
      </p>
     </li>
     <li class="list__item" id="tb7jv7_26">
      <p id="tb7jv7_31">
       Install the
       <a data-external="true" href="https://plugins.jetbrains.com/plugin/16340-kotlin-notebook" id="tb7jv7_33" rel="noopener noreferrer">
        Kotlin Notebook plugin
       </a>
       in IntelliJ IDEA.
      </p>
      <aside class="prompt" data-title="" data-type="tip" id="tb7jv7_32">
       <p id="tb7jv7_34">
        Alternatively, access the Kotlin Notebook plugin from
        <span class="control" id="tb7jv7_35">
         Settings
        </span>
        |
        <span class="control" id="tb7jv7_36">
         Plugins
        </span>
        |
        <span class="control" id="tb7jv7_37">
         Marketplace
        </span>
        within IntelliJ IDEA.
       </p>
      </aside>
     </li>
     <li class="list__item" id="tb7jv7_27">
      <p id="tb7jv7_38">
       Create a new notebook by selecting
       <span class="control" id="tb7jv7_39">
        File
       </span>
       |
       <span class="control" id="tb7jv7_40">
        New
       </span>
       |
       <span class="control" id="tb7jv7_41">
        Kotlin Notebook
       </span>
       .
      </p>
     </li>
     <li class="list__item" id="tb7jv7_28">
      <p id="tb7jv7_42">
       In your notebook, import the LPK and Kotlin DataFrame libraries by running the following command:
      </p>
      <div class="code-block" data-lang="kotlin">
       %use lets-plot
%use dataframe
      </div>
     </li>
    </ol>
   </section>
   <section class="chapter">
    <h2 data-toc="prepare-the-data" id="prepare-the-data">
     Prepare the data
    </h2>
    <p id="tb7jv7_44">
     Let's create a DataFrame that stores simulated numbers of the monthly average temperature in three cities: Berlin, Madrid, and Caracas.
    </p>
    <p id="tb7jv7_45">
     Use the
     <a data-external="true" href="https://kotlin.github.io/dataframe/createdataframe.html#dataframeof" id="tb7jv7_51" rel="noopener noreferrer">
      <code class="code" id="tb7jv7_52">
       dataFrameOf()
      </code>
     </a>
     function from the Kotlin DataFrame library to generate the DataFrame. Paste and run the following code snippet in your Kotlin Notebook:
    </p>
    <div class="code-block" data-lang="kotlin">
     // The months variable stores a list with 12 months of the year
val months = listOf(
    "January", "February",
    "March", "April", "May",
    "June", "July", "August",
    "September", "October", "November",
    "December"
)
// The tempBerlin, tempMadrid, and tempCaracas variables store a list with temperature values for each month
val tempBerlin =
    listOf(-0.5, 0.0, 4.8, 9.0, 14.3, 17.5, 19.2, 18.9, 14.5, 9.7, 4.7, 1.0)
val tempMadrid =
    listOf(6.3, 7.9, 11.2, 12.9, 16.7, 21.1, 24.7, 24.2, 20.3, 15.4, 9.9, 6.6)
val tempCaracas =
    listOf(27.5, 28.9, 29.6, 30.9, 31.7, 35.1, 33.8, 32.2, 31.3, 29.4, 28.9, 27.6)

// The df variable stores a DataFrame of three columns, including monthly records, temperature, and cities
val df = dataFrameOf(
    "Month" to months + months + months,
    "Temperature" to tempBerlin + tempMadrid + tempCaracas,
    "City" to List(12) { "Berlin" } + List(12) { "Madrid" } + List(12) { "Caracas" }
)
df.head(4)
    </div>
    <p id="tb7jv7_47">
     You can see that the DataFrame has three columns: Month, Temperature, and City. The first four rows of the DataFrame contain records of the temperature in Berlin from January to April:
    </p>
    <figure id="tb7jv7_48">
     <img alt="Dataframe exploration" height="219" src="images/visualization-dataframe-temperature.png" title="Dataframe exploration" width="600"/>
    </figure>
    <p id="tb7jv7_49">
     To create a plot using the LPK library, you need to convert your data (
     <code class="code" id="tb7jv7_53">
      df
     </code>
     ) into a
     <code class="code" id="tb7jv7_54">
      Map
     </code>
     type that stores the data in key-value pairs. You can easily convert a DataFrame into a
     <code class="code" id="tb7jv7_55">
      Map
     </code>
     using the
     <a data-external="true" href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/to-map.html" id="tb7jv7_56" rel="noopener noreferrer">
      <code class="code" id="tb7jv7_57">
       .toMap()
      </code>
     </a>
     function:
    </p>
    <div class="code-block" data-lang="kotlin">
     val data = df.toMap()
    </div>
   </section>
   <section class="chapter">
    <h2 data-toc="create-a-scatter-plot" id="create-a-scatter-plot">
     Create a scatter plot
    </h2>
    <p id="tb7jv7_58">
     Let's create a scatter plot in Kotlin Notebook with the LPK library.
    </p>
    <p id="tb7jv7_59">
     Once you have your data in the
     <code class="code" id="tb7jv7_63">
      Map
     </code>
     format, use the
     <a data-external="true" href="https://lets-plot.org/kotlin/api-reference/-lets--plot--kotlin/org.jetbrains.letsPlot.geom/geom-point/index.html" id="tb7jv7_64" rel="noopener noreferrer">
      <code class="code" id="tb7jv7_66">
       geomPoint()
      </code>
     </a>
     function from the LPK library to generate the scatter plot. You can specify the values for the X and Y axes, as well as define categories and their color. Additionally, you can
     <a data-external="true" href="https://lets-plot.org/kotlin/aesthetics.html#point-shapes" id="tb7jv7_65" rel="noopener noreferrer">
      customize
     </a>
     the plot's size and point shapes to suit your needs:
    </p>
    <div class="code-block" data-lang="kotlin">
     // Specifies X and Y axes, categories and their color, plot size, and plot type
val scatterPlot =
    letsPlot(data) { x = "Month"; y = "Temperature"; color = "City" } + ggsize(600, 500) + geomPoint(shape = 15)
scatterPlot
    </div>
    <p id="tb7jv7_61">
     Here's the result:
    </p>
    <figure id="tb7jv7_62">
     <img alt="Scatter plot" height="500" src="images/lets-plot-scatter.svg" title="Scatter plot" width="600"/>
    </figure>
   </section>
   <section class="chapter">
    <h2 data-toc="create-a-box-plot" id="create-a-box-plot">
     Create a box plot
    </h2>
    <p id="tb7jv7_67">
     Let's visualize the
     <a data-tooltip="Let's create a DataFrame that stores simulated numbers of the monthly average temperature in three cities: Berlin, Madrid, and Caracas." href="#prepare-the-data" id="tb7jv7_71">
      data
     </a>
     in a box plot. Use the
     <a data-external="true" href="https://lets-plot.org/kotlin/api-reference/-lets--plot--kotlin/org.jetbrains.letsPlot.geom/geom-boxplot.html" id="tb7jv7_72" rel="noopener noreferrer">
      <code class="code" id="tb7jv7_75">
       geomBoxplot()
      </code>
     </a>
     function from the LPK library to generate the plot and
     <a data-external="true" href="https://lets-plot.org/kotlin/aesthetics.html#point-shapes" id="tb7jv7_73" rel="noopener noreferrer">
      customize
     </a>
     colors with the
     <a data-external="true" href="https://lets-plot.org/kotlin/api-reference/-lets--plot--kotlin/org.jetbrains.letsPlot.scale/scale-fill-manual.html" id="tb7jv7_74" rel="noopener noreferrer">
      <code class="code" id="tb7jv7_76">
       scaleFillManual()
      </code>
     </a>
     function:
    </p>
    <div class="code-block" data-lang="kotlin">
     // Specifies X and Y axes, categories, plot size, and plot type
val boxPlot = ggplot(data) { x = "City"; y = "Temperature" } + ggsize(700, 500) + geomBoxplot { fill = "City" } +
    // Customizes colors        
    scaleFillManual(values = listOf("light_yellow", "light_magenta", "light_green"))
boxPlot
    </div>
    <p id="tb7jv7_69">
     Here's the result:
    </p>
    <figure id="tb7jv7_70">
     <img alt="Box plot" height="429" src="images/box-plot.svg" title="Box plot" width="600"/>
    </figure>
   </section>
   <section class="chapter">
    <h2 data-toc="create-a-2d-density-plot" id="create-a-2d-density-plot">
     Create a 2D density plot
    </h2>
    <p id="tb7jv7_77">
     Now, let's create a 2D density plot to visualize the distribution and concentration of some random data.
    </p>
    <section class="chapter">
     <h3 data-toc="prepare-the-data-for-the-2d-density-plot" id="prepare-the-data-for-the-2d-density-plot">
      Prepare the data for the 2D density plot
     </h3>
     <ol class="list _decimal" id="tb7jv7_80" type="1">
      <li class="list__item" id="tb7jv7_81">
       <p id="tb7jv7_84">
        Import the dependencies to process the data and generate the plot:
       </p>
       <div class="code-block" data-lang="kotlin">
        %use lets-plot

@file:DependsOn("org.apache.commons:commons-math3:3.6.1")
import org.apache.commons.math3.distribution.MultivariateNormalDistribution
       </div>
       <aside class="prompt" data-title="" data-type="tip" id="tb7jv7_86">
        <p id="tb7jv7_87">
         For more information about importing dependencies to Kotlin Notebook, see the
         <a data-external="true" href="https://www.jetbrains.com/help/idea/kotlin-notebook.html#add-dependencies" id="tb7jv7_88" rel="noopener noreferrer">
          Kotlin Notebook documentation
         </a>
         .
        </p>
       </aside>
      </li>
      <li class="list__item" id="tb7jv7_82">
       <p id="tb7jv7_89">
        Paste and run the following code snippet in your Kotlin Notebook to create sets of 2D data points:
       </p>
       <div class="code-block" data-lang="kotlin">
        // Defines covariance matrices for three distributions
val cov0: Array&lt;DoubleArray&gt; = arrayOf(
    doubleArrayOf(1.0, -.8),
    doubleArrayOf(-.8, 1.0)
)

val cov1: Array&lt;DoubleArray&gt; = arrayOf(
    doubleArrayOf(1.0, .8),
    doubleArrayOf(.8, 1.0)
)

val cov2: Array&lt;DoubleArray&gt; = arrayOf(
    doubleArrayOf(10.0, .1),
    doubleArrayOf(.1, .1)
)

// Defines the number of samples
val n = 400

// Defines means for three distributions
val means0: DoubleArray = doubleArrayOf(-2.0, 0.0)
val means1: DoubleArray = doubleArrayOf(2.0, 0.0)
val means2: DoubleArray = doubleArrayOf(0.0, 1.0)

// Generates random samples from three multivariate normal distributions
val xy0 = MultivariateNormalDistribution(means0, cov0).sample(n)
val xy1 = MultivariateNormalDistribution(means1, cov1).sample(n)
val xy2 = MultivariateNormalDistribution(means2, cov2).sample(n)
       </div>
       <p id="tb7jv7_91">
        From the code above, the
        <code class="code" id="tb7jv7_92">
         xy0
        </code>
        ,
        <code class="code" id="tb7jv7_93">
         xy1
        </code>
        , and
        <code class="code" id="tb7jv7_94">
         xy2
        </code>
        variables store arrays with 2D (
        <code class="code" id="tb7jv7_95">
         x, y
        </code>
        ) data points.
       </p>
      </li>
      <li class="list__item" id="tb7jv7_83">
       <p id="tb7jv7_96">
        Convert your data into a
        <code class="code" id="tb7jv7_98">
         Map
        </code>
        type:
       </p>
       <div class="code-block" data-lang="kotlin">
        val data = mapOf(
    "x" to (xy0.map { it[0] } + xy1.map { it[0] } + xy2.map { it[0] }).toList(),
    "y" to (xy0.map { it[1] } + xy1.map { it[1] } + xy2.map { it[1] }).toList()
)
       </div>
      </li>
     </ol>
    </section>
    <section class="chapter">
     <h3 data-toc="generate-the-2d-density-plot" id="generate-the-2d-density-plot">
      Generate the 2D density plot
     </h3>
     <p id="tb7jv7_99">
      Using the
      <code class="code" id="tb7jv7_103">
       Map
      </code>
      from the previous step, create a 2D density plot (
      <code class="code" id="tb7jv7_104">
       geomDensity2D
      </code>
      ) with a scatter plot (
      <code class="code" id="tb7jv7_105">
       geomPoint
      </code>
      ) in the background to better visualize the data points and outliers. You can use the
      <a data-external="true" href="https://lets-plot.org/kotlin/api-reference/-lets--plot--kotlin/org.jetbrains.letsPlot.scale/scale-color-gradient.html" id="tb7jv7_106" rel="noopener noreferrer">
       <code class="code" id="tb7jv7_107">
        scaleColorGradient()
       </code>
      </a>
      function to customize the scale of colors:
     </p>
     <div class="code-block" data-lang="kotlin">
      val densityPlot = letsPlot(data) { x = "x"; y = "y" } + ggsize(600, 300) + geomPoint(
    color = "black",
    alpha = .1
) + geomDensity2D { color = "..level.." } +
        scaleColorGradient(low = "dark_green", high = "yellow", guide = guideColorbar(barHeight = 10, barWidth = 300)) +
        theme().legendPositionBottom()
densityPlot
     </div>
     <p id="tb7jv7_101">
      Here's the result:
     </p>
     <figure id="tb7jv7_102">
      <img alt="2D density plot" height="300" src="images/2d-density-plot.svg" title="2D density plot" width="600"/>
     </figure>
    </section>
   </section>
   <section class="chapter">
    <h2 data-toc="what-s-next" id="what-s-next">
     What's next
    </h2>
    <ul class="list _bullet" id="tb7jv7_108">
     <li class="list__item" id="tb7jv7_109">
      <p>
       Explore more plot examples in the
       <a data-external="true" href="https://lets-plot.org/kotlin/charts.html" id="tb7jv7_113" rel="noopener noreferrer">
        Lets-Plot for Kotlin's documentation
       </a>
       .
      </p>
     </li>
     <li class="list__item" id="tb7jv7_110">
      <p>
       Check the Lets-Plot for Kotlin's
       <a data-external="true" href="https://lets-plot.org/kotlin/api-reference/" id="tb7jv7_114" rel="noopener noreferrer">
        API reference
       </a>
       .
      </p>
     </li>
     <li class="list__item" id="tb7jv7_111">
      <p>
       Learn about transforming and visualizing data with Kotlin in the
       <a data-external="true" href="https://kotlin.github.io/dataframe/info.html" id="tb7jv7_115" rel="noopener noreferrer">
        Kotlin DataFrame
       </a>
       and
       <a data-external="true" href="https://kotlin.github.io/kandy/welcome.html" id="tb7jv7_116" rel="noopener noreferrer">
        Kandy
       </a>
       library documentation.
      </p>
     </li>
     <li class="list__item" id="tb7jv7_112">
      <p>
       Find additional information about the
       <a data-external="true" href="https://www.jetbrains.com/help/idea/kotlin-notebook.html" id="tb7jv7_117" rel="noopener noreferrer">
        Kotlin Notebook's usage and key features
       </a>
       .
      </p>
     </li>
    </ul>
   </section>
   <div class="last-modified">
    Last modified: 16 December 2024
   </div>
   <div data-feedback-placeholder="true">
   </div>
  </div>
 </body>
</html>
