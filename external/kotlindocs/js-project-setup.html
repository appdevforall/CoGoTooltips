<html>
 <head>
  <meta charset="utf-8"/>
  <link href="doc_style.css" rel="stylesheet"/>
 </head>
 <body>
  <a class="menu-link" href="toc.html">
   MENU
  </a>
  <hr/>
  <div class="article-content">
   <h1 data-toc="js-project-setup" id="js-project-setup.md">
    Set up a Kotlin/JS project
   </h1>
   <p id="-gr4oxw_2">
    Kotlin/JS projects use Gradle as a build system. To let developers easily manage their Kotlin/JS projects, we offer the
    <code class="code" id="-gr4oxw_22">
     kotlin.multiplatform
    </code>
    Gradle plugin that provides project configuration tools together with helper tasks for automating routines typical for JavaScript development.
   </p>
   <p id="-gr4oxw_3">
    The plugin downloads npm dependencies in the background using the
    <a data-external="true" href="https://www.npmjs.com/" id="-gr4oxw_23" rel="noopener noreferrer">
     npm
    </a>
    or
    <a data-external="true" href="https://yarnpkg.com/" id="-gr4oxw_24" rel="noopener noreferrer">
     Yarn
    </a>
    package managers and builds a JavaScript bundle from a Kotlin project using
    <a data-external="true" href="https://webpack.js.org/" id="-gr4oxw_25" rel="noopener noreferrer">
     webpack
    </a>
    . Dependency management and configuration adjustments can be done to a large part directly from the Gradle build file, with the option to override automatically generated configurations for full control.
   </p>
   <p id="-gr4oxw_4">
    You can apply the
    <code class="code" id="-gr4oxw_26">
     org.jetbrains.kotlin.multiplatform
    </code>
    plugin to a Gradle project manually in the
    <code class="code" id="-gr4oxw_27">
     build.gradle(.kts)
    </code>
    file:
   </p>
   <div class="tabs" data-anchors="[-gr4oxw_28,-gr4oxw_29]" data-group="build-script" id="-gr4oxw_5">
    <div class="tabs__content" data-gtm="tab" data-sync-tabs="kotlin" data-title="Kotlin" id="-gr4oxw_28">
     <div class="code-block" data-lang="kotlin" data-title="Kotlin">
      plugins {
    kotlin("multiplatform") version "2.1.0"
}
     </div>
    </div>
    <div class="tabs__content" data-gtm="tab" data-sync-tabs="groovy" data-title="Groovy" id="-gr4oxw_29">
     <div class="code-block" data-lang="groovy" data-title="Groovy">
      plugins {
    id 'org.jetbrains.kotlin.multiplatform' version '2.1.0'
}
     </div>
    </div>
   </div>
   <p id="-gr4oxw_6">
    The Kotlin Multiplatform Gradle plugin lets you manage aspects of your project in the
    <code class="code" id="-gr4oxw_32">
     kotlin {}
    </code>
    block of the build script:
   </p>
   <div class="code-block" data-lang="groovy">
    kotlin {
    // ...
}
   </div>
   <p id="-gr4oxw_8">
    Inside the
    <code class="code" id="-gr4oxw_33">
     kotlin {}
    </code>
    block, you can manage the following aspects:
   </p>
   <ul class="list _bullet" id="-gr4oxw_9">
    <li class="list__item" id="-gr4oxw_34">
     <p>
      <a data-tooltip="Kotlin/JS projects can target two different execution environments:" href="#execution-environments" id="-gr4oxw_42">
       Target execution environment
      </a>
      : browser or Node.js
     </p>
    </li>
    <li class="list__item" id="-gr4oxw_35">
     <p>
      <a data-tooltip="Kotlin provides an Experimental support for the following ES2015 features:" href="#support-for-es2015-features" id="-gr4oxw_43">
       Support for ES2015 features
      </a>
      : classes, modules, and generators
     </p>
    </li>
    <li class="list__item" id="-gr4oxw_36">
     <p>
      <a data-tooltip="Like any other Gradle projects, Kotlin/JS projects support traditional Gradle dependency declarations in the dependencies {} block of the build script:" href="#dependencies" id="-gr4oxw_44">
       Project dependencies
      </a>
      : Maven and npm
     </p>
    </li>
    <li class="list__item" id="-gr4oxw_37">
     <p>
      <a data-tooltip="The Kotlin Multiplatform Gradle plugin provides a jsRun task that lets you run pure Kotlin/JS projects without additional configuration." href="#run-task" id="-gr4oxw_45">
       Run configuration
      </a>
     </p>
    </li>
    <li class="list__item" id="-gr4oxw_38">
     <p>
      <a data-tooltip="The Kotlin Multiplatform Gradle plugin automatically sets up a test infrastructure for projects. For browser projects, it downloads and installs the Karma test runner with other required dependencies; for Node.js projects, the Mocha test framework is used." href="#test-task" id="-gr4oxw_46">
       Test configuration
      </a>
     </p>
    </li>
    <li class="list__item" id="-gr4oxw_39">
     <p>
      <a data-tooltip="For browser targets, the Kotlin Multiplatform Gradle plugin uses the widely known webpack module bundler." href="#webpack-bundling" id="-gr4oxw_47">
       Bundling
      </a>
      and
      <a data-tooltip="The Kotlin Multiplatform Gradle plugin also provides support for webpack's CSS and style loaders. While all options can be changed by directly modifying the webpack configuration files that are used to build your project, the most commonly used settings are available directly fromâ€¦" href="#css" id="-gr4oxw_48">
       CSS support
      </a>
      for browser projects
     </p>
    </li>
    <li class="list__item" id="-gr4oxw_40">
     <p>
      <a data-tooltip="By default, the results of a Kotlin/JS project build reside in the /build/dist/&lt;targetName&gt;/&lt;binaryName&gt; directory within the project root." href="#distribution-target-directory" id="-gr4oxw_49">
       Target directory
      </a>
      and
      <a data-tooltip="To adjust the name for the JavaScript module (which is generated in build/js/packages/myModuleName), including the corresponding .js and .d.ts files, use the moduleName option:" href="#module-name" id="-gr4oxw_50">
       module name
      </a>
     </p>
    </li>
    <li class="list__item" id="-gr4oxw_41">
     <p>
      <a data-tooltip="The package.json file holds the metadata of a JavaScript package. Popular package registries such as npm require all published packages to have such a file. They use it to track and manage package publications." href="#package-json-customization" id="-gr4oxw_51">
       Project's
       <code class="code" id="-gr4oxw_52">
        package.json
       </code>
       file
      </a>
     </p>
    </li>
   </ul>
   <section class="chapter">
    <h2 data-toc="execution-environments" id="execution-environments">
     Execution environments
    </h2>
    <p id="-gr4oxw_53">
     Kotlin/JS projects can target two different execution environments:
    </p>
    <ul class="list _bullet" id="-gr4oxw_54">
     <li class="list__item" id="-gr4oxw_60">
      <p>
       Browser for client-side scripting in browsers
      </p>
     </li>
     <li class="list__item" id="-gr4oxw_61">
      <p>
       <a data-external="true" href="https://nodejs.org/" id="-gr4oxw_62" rel="noopener noreferrer">
        Node.js
       </a>
       for running JavaScript code outside of a browser, for example, for server-side scripting.
      </p>
     </li>
    </ul>
    <p id="-gr4oxw_55">
     To define the target execution environment for a Kotlin/JS project, add the
     <code class="code" id="-gr4oxw_63">
      js {}
     </code>
     block with
     <code class="code" id="-gr4oxw_64">
      browser {}
     </code>
     or
     <code class="code" id="-gr4oxw_65">
      nodejs {}
     </code>
     inside:
    </p>
    <div class="code-block" data-lang="groovy">
     kotlin {
    js {
        browser {
        }
        binaries.executable()
    }
}
    </div>
    <p id="-gr4oxw_57">
     The instruction
     <code class="code" id="-gr4oxw_66">
      binaries.executable()
     </code>
     explicitly instructs the Kotlin compiler to emit executable
     <code class="code" id="-gr4oxw_67">
      .js
     </code>
     files. This is the default behavior when using the current Kotlin/JS compiler, but the instruction is explicitly required if you are working with the
     <a data-tooltip="The Kotlin/JS IR compiler backend is the main focus of innovation around Kotlin/JS, and paves the way forward for the technology." href="js-ir-compiler.html" id="-gr4oxw_68">
      Kotlin/JS IR compiler
     </a>
     , or have set
     <code class="code" id="-gr4oxw_69">
      kotlin.js.generate.executable.default=false
     </code>
     in the
     <code class="code" id="-gr4oxw_70">
      gradle.properties
     </code>
     file. In those cases, omitting
     <code class="code" id="-gr4oxw_71">
      binaries.executable()
     </code>
     will cause the compiler to only generate Kotlin-internal library files, which can be used from other projects, but not run on their own.
    </p>
    <aside class="prompt" data-title="" data-type="tip" id="-gr4oxw_58">
     <p id="-gr4oxw_72">
      This is typically faster than creating executable files, and can be a possible optimization when dealing with non-leaf modules of your project.
     </p>
    </aside>
    <p id="-gr4oxw_59">
     The Kotlin Multiplatform plugin automatically configures its tasks for working with the selected environment. This includes downloading and installing the required environment and dependencies for running and testing the application. This allows developers to build, run, and test simple projects without additional configuration. For projects targeting Node.js, there is also an option to use an existing Node.js installation. Learn how to
     <a data-tooltip="If Node.js is already installed on the host where you build Kotlin/JS projects, you can configure the Kotlin Multiplatform Gradle plugin to use it instead of installing its own Node.js instance." href="#use-pre-installed-node-js" id="-gr4oxw_73">
      use pre-installed Node.js
     </a>
     .
    </p>
   </section>
   <section class="chapter">
    <h2 data-toc="support-for-es2015-features" id="support-for-es2015-features">
     Support for ES2015 features
    </h2>
    <p id="-gr4oxw_74">
     Kotlin provides an
     <a data-tooltip="Here's a quick guide to these stability levels and their meaning:" href="components-stability.html#stability-levels-explained" id="-gr4oxw_79">
      Experimental
     </a>
     support for the following ES2015 features:
    </p>
    <ul class="list _bullet" id="-gr4oxw_75">
     <li class="list__item" id="-gr4oxw_80">
      <p>
       Modules that simplify your codebase and improve maintainability.
      </p>
     </li>
     <li class="list__item" id="-gr4oxw_81">
      <p>
       Classes that allow incorporating OOP principles, resulting in cleaner and more intuitive code.
      </p>
     </li>
     <li class="list__item" id="-gr4oxw_82">
      <p>
       Generators for compiling
       <span id="-gr4oxw_83">
        suspend functions
       </span>
       that improve the final bundle size and help with debugging.
      </p>
     </li>
    </ul>
    <p id="-gr4oxw_76">
     You can enable all the supported ES2015 features at once by adding the
     <code class="code" id="-gr4oxw_84">
      es2015
     </code>
     compilation target to your
     <code class="code" id="-gr4oxw_85">
      build.gradle(.kts)
     </code>
     file:
    </p>
    <div class="code-block" data-lang="kotlin">
     tasks.withType&lt;KotlinJsCompile&gt;().configureEach {
    kotlinOptions {
        target = "es2015"
    }
}
    </div>
    <p id="-gr4oxw_78">
     <a data-external="true" href="https://262.ecma-international.org/6.0/" id="-gr4oxw_86" rel="noopener noreferrer">
      Learn more about ES2015 (ECMAScript 2015, ES6) in the official documentation
     </a>
     .
    </p>
   </section>
   <section class="chapter">
    <h2 data-toc="dependencies" id="dependencies">
     Dependencies
    </h2>
    <p id="-gr4oxw_87">
     Like any other Gradle projects, Kotlin/JS projects support traditional Gradle
     <a data-external="true" href="https://docs.gradle.org/current/userguide/declaring_dependencies.html" id="-gr4oxw_95" rel="noopener noreferrer">
      dependency declarations
     </a>
     in the
     <code class="code" id="-gr4oxw_96">
      dependencies {}
     </code>
     block of the build script:
    </p>
    <div class="tabs" data-anchors="[-gr4oxw_97,-gr4oxw_98]" data-group="build-script" id="-gr4oxw_88">
     <div class="tabs__content" data-gtm="tab" data-sync-tabs="kotlin" data-title="Kotlin" id="-gr4oxw_97">
      <div class="code-block" data-lang="kotlin" data-title="Kotlin">
       dependencies {
    implementation("org.example.myproject", "1.1.0")
}
      </div>
     </div>
     <div class="tabs__content" data-gtm="tab" data-sync-tabs="groovy" data-title="Groovy" id="-gr4oxw_98">
      <div class="code-block" data-lang="groovy" data-title="Groovy">
       dependencies {
    implementation 'org.example.myproject:1.1.0'
}
      </div>
     </div>
    </div>
    <p id="-gr4oxw_89">
     The Kotlin Multiplatform Gradle plugin also supports dependency declarations for particular source sets in the
     <code class="code" id="-gr4oxw_101">
      kotlin {}
     </code>
     block of the build script:
    </p>
    <div class="tabs" data-anchors="[-gr4oxw_102,-gr4oxw_103]" data-group="build-script" id="-gr4oxw_90">
     <div class="tabs__content" data-gtm="tab" data-sync-tabs="kotlin" data-title="Kotlin" id="-gr4oxw_102">
      <div class="code-block" data-lang="kotlin" data-title="Kotlin">
       kotlin {
    sourceSets {
        val jsMain by getting {
            dependencies {
                implementation("org.example.myproject:1.1.0")
            }
        }
    }
}
      </div>
     </div>
     <div class="tabs__content" data-gtm="tab" data-sync-tabs="groovy" data-title="Groovy" id="-gr4oxw_103">
      <div class="code-block" data-lang="groovy" data-title="Groovy">
       kotlin {
    sourceSets {
        jsMain {
            dependencies {
                implementation 'org.example.myproject:1.1.0'
            }
        }
    }
}
      </div>
     </div>
    </div>
    <aside class="prompt" data-title="" data-type="note" id="-gr4oxw_91">
     <p id="-gr4oxw_106">
      Not all libraries available for the Kotlin programming language are available when targeting JavaScript: only libraries that include artifacts for Kotlin/JS can be used.
     </p>
    </aside>
    <p id="-gr4oxw_92">
     If the library you are adding has dependencies on
     <a data-tooltip="In the JavaScript world, the most common way to manage dependencies is npm. It offers the biggest public repository of JavaScript modules." href="#npm-dependencies" id="-gr4oxw_107">
      packages from npm
     </a>
     , Gradle will automatically resolve these transitive dependencies as well.
    </p>
    <section class="chapter">
     <h3 data-toc="kotlin-standard-libraries" id="kotlin-standard-libraries">
      Kotlin standard libraries
     </h3>
     <p id="-gr4oxw_108">
      The dependencies on the
      <a data-external="true" href="https://kotlinlang.org/api/latest/jvm/stdlib/index.html" id="-gr4oxw_111" rel="noopener noreferrer">
       standard library
      </a>
      are added automatically. The version of the standard library is the same as the version of the Kotlin Multiplatform plugin.
     </p>
     <p id="-gr4oxw_109">
      For multiplatform tests, the
      <a data-external="true" href="https://kotlinlang.org/api/latest/kotlin.test/" id="-gr4oxw_112" rel="noopener noreferrer">
       <code class="code" id="-gr4oxw_114">
        kotlin.test
       </code>
      </a>
      API is available. When you create a multiplatform project, you can add test dependencies to all the source sets by using a single dependency in
      <code class="code" id="-gr4oxw_113">
       commonTest
      </code>
      :
     </p>
     <div class="tabs" data-anchors="[-gr4oxw_115,-gr4oxw_116]" data-group="build-script" id="-gr4oxw_110">
      <div class="tabs__content" data-gtm="tab" data-sync-tabs="kotlin" data-title="Kotlin" id="-gr4oxw_115">
       <div class="code-block" data-lang="kotlin" data-title="Kotlin">
        kotlin {
    sourceSets {
        commonTest.dependencies {
            implementation(kotlin("test")) // Brings all the platform dependencies automatically
        }
    }
}
       </div>
      </div>
      <div class="tabs__content" data-gtm="tab" data-sync-tabs="groovy" data-title="Groovy" id="-gr4oxw_116">
       <div class="code-block" data-lang="groovy" data-title="Groovy">
        kotlin {
    sourceSets {
        commonTest {
            dependencies {
                implementation kotlin("test") // Brings all the platform dependencies automatically
            }
        }
    }
}
       </div>
      </div>
     </div>
    </section>
    <section class="chapter">
     <h3 data-toc="npm-dependencies" id="npm-dependencies">
      npm dependencies
     </h3>
     <p id="-gr4oxw_119">
      In the JavaScript world, the most common way to manage dependencies is
      <a data-external="true" href="https://www.npmjs.com/" id="-gr4oxw_129" rel="noopener noreferrer">
       npm
      </a>
      . It offers the biggest public repository of JavaScript modules.
     </p>
     <p id="-gr4oxw_120">
      The Kotlin Multiplatform Gradle plugin lets you declare npm dependencies in the Gradle build script, just how you declare any other dependencies.
     </p>
     <p id="-gr4oxw_121">
      To declare an npm dependency, pass its name and version to the
      <code class="code" id="-gr4oxw_130">
       npm()
      </code>
      function inside a dependency declaration. You can also specify one or multiple version ranges based on
      <a data-external="true" href="https://docs.npmjs.com/about-semantic-versioning" id="-gr4oxw_131" rel="noopener noreferrer">
       npm's semver syntax
      </a>
      .
     </p>
     <div class="tabs" data-anchors="[-gr4oxw_132,-gr4oxw_133]" data-group="build-script" id="-gr4oxw_122">
      <div class="tabs__content" data-gtm="tab" data-sync-tabs="kotlin" data-title="Kotlin" id="-gr4oxw_132">
       <div class="code-block" data-lang="kotlin" data-title="Kotlin">
        dependencies {
    implementation(npm("react", "&gt; 14.0.0 &lt;=16.9.0"))
}
       </div>
      </div>
      <div class="tabs__content" data-gtm="tab" data-sync-tabs="groovy" data-title="Groovy" id="-gr4oxw_133">
       <div class="code-block" data-lang="groovy" data-title="Groovy">
        dependencies {
    implementation npm('react', '&gt; 14.0.0 &lt;=16.9.0')
}
       </div>
      </div>
     </div>
     <p id="-gr4oxw_123">
      By default, the plugin uses a separate instance of the
      <a data-external="true" href="https://yarnpkg.com/lang/en/" id="-gr4oxw_136" rel="noopener noreferrer">
       Yarn
      </a>
      package manager to download and install npm dependencies. It works out of the box without additional configuration, but you can
      <a data-tooltip="By default, to download and install your declared dependencies at build time, the plugin manages its own instance of the Yarn package manager. It works out of the box without additional configuration, but you can tune it or use Yarn already installed on your host." href="#yarn" id="-gr4oxw_137">
       tune it to specific needs
      </a>
      .
     </p>
     <p id="-gr4oxw_124">
      You can also work with npm dependencies directly using the
      <a data-external="true" href="https://www.npmjs.com/" id="-gr4oxw_138" rel="noopener noreferrer">
       npm
      </a>
      package manager instead. To use npm as your package manager, in your
      <code class="code" id="-gr4oxw_139">
       gradle.properties
      </code>
      file, set the following property:
     </p>
     <div class="code-block" data-lang="none">
      kotlin.js.yarn=false
     </div>
     <p id="-gr4oxw_126">
      Besides regular dependencies, there are three more types of dependencies that can be used from the Gradle DSL. To learn more about when each type of dependency can best be used, have a look at the official documentation linked from npm:
     </p>
     <ul class="list _bullet" id="-gr4oxw_127">
      <li class="list__item" id="-gr4oxw_140">
       <p>
        <a data-external="true" href="https://docs.npmjs.com/files/package.json#devdependencies" id="-gr4oxw_143" rel="noopener noreferrer">
         devDependencies
        </a>
        , via
        <code class="code" id="-gr4oxw_144">
         devNpm(...)
        </code>
        ,
       </p>
      </li>
      <li class="list__item" id="-gr4oxw_141">
       <p>
        <a data-external="true" href="https://docs.npmjs.com/files/package.json#optionaldependencies" id="-gr4oxw_145" rel="noopener noreferrer">
         optionalDependencies
        </a>
        via
        <code class="code" id="-gr4oxw_146">
         optionalNpm(...)
        </code>
        , and
       </p>
      </li>
      <li class="list__item" id="-gr4oxw_142">
       <p>
        <a data-external="true" href="https://docs.npmjs.com/files/package.json#peerdependencies" id="-gr4oxw_147" rel="noopener noreferrer">
         peerDependencies
        </a>
        via
        <code class="code" id="-gr4oxw_148">
         peerNpm(...)
        </code>
        .
       </p>
      </li>
     </ul>
     <p id="-gr4oxw_128">
      Once an npm dependency is installed, you can use its API in your code as described in
      <a data-tooltip="Kotlin was first designed for easy interoperation with the Java platform: it sees Java classes as Kotlin classes, and Java sees Kotlin classes as Java classes." href="js-interop.html" id="-gr4oxw_149">
       Calling JS from Kotlin
      </a>
      .
     </p>
    </section>
   </section>
   <section class="chapter">
    <h2 data-toc="run-task" id="run-task">
     run task
    </h2>
    <p id="-gr4oxw_150">
     The Kotlin Multiplatform Gradle plugin provides a
     <code class="code" id="-gr4oxw_160">
      jsRun
     </code>
     task that lets you run pure Kotlin/JS projects without additional configuration.
    </p>
    <p id="-gr4oxw_151">
     For running Kotlin/JS projects in the browser, this task is an alias for the
     <code class="code" id="-gr4oxw_161">
      browserDevelopmentRun
     </code>
     task (which is also available in Kotlin multiplatform projects). It uses the
     <a data-external="true" href="https://webpack.js.org/configuration/dev-server/" id="-gr4oxw_162" rel="noopener noreferrer">
      webpack-dev-server
     </a>
     to serve your JavaScript artifacts. If you want to customize the configuration used by
     <code class="code" id="-gr4oxw_163">
      webpack-dev-server
     </code>
     , for example, adjust the port the server runs on, use the
     <a data-tooltip="For browser targets, the Kotlin Multiplatform Gradle plugin uses the widely known webpack module bundler." href="#webpack-bundling" id="-gr4oxw_164">
      webpack configuration file
     </a>
     .
    </p>
    <p id="-gr4oxw_152">
     For running Kotlin/JS projects targeting Node.js, use the
     <code class="code" id="-gr4oxw_165">
      jsRun
     </code>
     task that is an alias for the
     <code class="code" id="-gr4oxw_166">
      nodeRun
     </code>
     task.
    </p>
    <p id="-gr4oxw_153">
     To run a project, execute the standard lifecycle
     <code class="code" id="-gr4oxw_167">
      jsRun
     </code>
     task, or the alias to which it corresponds:
    </p>
    <div class="code-block" data-lang="bash">
     ./gradlew jsRun
    </div>
    <p id="-gr4oxw_155">
     To automatically trigger a re-build of your application after making changes to the source files, use the Gradle
     <a data-external="true" href="https://docs.gradle.org/current/userguide/command_line_interface.html#sec:continuous_build" id="-gr4oxw_168" rel="noopener noreferrer">
      continuous build
     </a>
     feature:
    </p>
    <div class="code-block" data-lang="bash">
     ./gradlew jsRun --continuous
    </div>
    <p id="-gr4oxw_157">
     or
    </p>
    <div class="code-block" data-lang="bash">
     ./gradlew jsRun -t
    </div>
    <p id="-gr4oxw_159">
     Once the build of your project has succeeded, the
     <code class="code" id="-gr4oxw_169">
      webpack-dev-server
     </code>
     will automatically refresh the browser page.
    </p>
   </section>
   <section class="chapter">
    <h2 data-toc="test-task" id="test-task">
     test task
    </h2>
    <p id="-gr4oxw_170">
     The Kotlin Multiplatform Gradle plugin automatically sets up a test infrastructure for projects. For browser projects, it downloads and installs the
     <a data-external="true" href="https://karma-runner.github.io/" id="-gr4oxw_186" rel="noopener noreferrer">
      Karma
     </a>
     test runner with other required dependencies; for Node.js projects, the
     <a data-external="true" href="https://mochajs.org/" id="-gr4oxw_187" rel="noopener noreferrer">
      Mocha
     </a>
     test framework is used.
    </p>
    <p id="-gr4oxw_171">
     The plugin also provides useful testing features, for example:
    </p>
    <ul class="list _bullet" id="-gr4oxw_172">
     <li class="list__item" id="-gr4oxw_188">
      <p>
       Source maps generation
      </p>
     </li>
     <li class="list__item" id="-gr4oxw_189">
      <p>
       Test reports generation
      </p>
     </li>
     <li class="list__item" id="-gr4oxw_190">
      <p>
       Test run results in the console
      </p>
     </li>
    </ul>
    <p id="-gr4oxw_173">
     For running browser tests, the plugin uses
     <a data-external="true" href="https://chromium.googlesource.com/chromium/src/+/lkgr/headless/README.md" id="-gr4oxw_191" rel="noopener noreferrer">
      Headless Chrome
     </a>
     by default. You can also choose another browser to run tests in, by adding the corresponding entries inside the
     <code class="code" id="-gr4oxw_192">
      useKarma {}
     </code>
     block of the build script:
    </p>
    <div class="code-block" data-lang="groovy">
     kotlin {
    js {
        browser {
            testTask {
                useKarma {
                    useIe()
                    useSafari()
                    useFirefox()
                    useChrome()
                    useChromeCanary()
                    useChromeHeadless()
                    usePhantomJS()
                    useOpera()
                }
            }
        }
        binaries.executable()
        // ...
    }
}
    </div>
    <p id="-gr4oxw_175">
     Alternatively, you can add test targets for browsers in the
     <code class="code" id="-gr4oxw_193">
      gradle.properties
     </code>
     file:
    </p>
    <div class="code-block" data-lang="none">
     kotlin.js.browser.karma.browsers=firefox,safari
    </div>
    <p id="-gr4oxw_177">
     This approach allows you to define a list of browsers for all modules, and then add specific browsers in the build scripts of particular modules.
    </p>
    <p id="-gr4oxw_178">
     Please note that the Kotlin Multiplatform Gradle plugin does not automatically install these browsers for you, but only uses those that are available in its execution environment. If you are executing Kotlin/JS tests on a continuous integration server, for example, make sure that the browsers you want to test against are installed.
    </p>
    <p id="-gr4oxw_179">
     If you want to skip tests, add the line
     <code class="code" id="-gr4oxw_194">
      enabled = false
     </code>
     to the
     <code class="code" id="-gr4oxw_195">
      testTask {}
     </code>
     :
    </p>
    <div class="code-block" data-lang="groovy">
     kotlin {
    js {
        browser {
            testTask {
                enabled = false
            }
        }
        binaries.executable()
        // ...
    }
}
    </div>
    <p id="-gr4oxw_181">
     To run tests, execute the standard lifecycle
     <code class="code" id="-gr4oxw_196">
      check
     </code>
     task:
    </p>
    <div class="code-block" data-lang="bash">
     ./gradlew check
    </div>
    <p id="-gr4oxw_183">
     To specify environment variables used by your Node.js test runners (for example, to pass external information to your tests, or to fine-tune package resolution), use the
     <code class="code" id="-gr4oxw_197">
      environment()
     </code>
     function with a key-value pair inside the
     <code class="code" id="-gr4oxw_198">
      testTask {}
     </code>
     block in your build script:
    </p>
    <div class="code-block" data-lang="groovy">
     kotlin {
    js {
        nodejs {
            testTask {
                environment("key", "value")
            }
        }
    }
}
    </div>
    <section class="chapter">
     <h3 data-toc="karma-configuration" id="karma-configuration">
      Karma configuration
     </h3>
     <p id="-gr4oxw_199">
      The Kotlin Multiplatform Gradle plugin automatically generates a Karma configuration file at build time which includes your settings from the
      <a data-tooltip="The Kotlin Multiplatform Gradle plugin automatically sets up a test infrastructure for projects. For browser projects, it downloads and installs the Karma test runner with other required dependencies; for Node.js projects, the Mocha test framework is used." href="#test-task" id="-gr4oxw_201">
       <code class="code" id="-gr4oxw_207">
        kotlin.js.browser.testTask.useKarma {}
       </code>
       block
      </a>
      in your
      <code class="code" id="-gr4oxw_202">
       build.gradle(.kts)
      </code>
      . You can find the file at
      <code class="code" id="-gr4oxw_203">
       build/js/packages/projectName-test/karma.conf.js
      </code>
      . To make adjustments to the configuration used by Karma, place your additional configuration files inside a directory called
      <code class="code" id="-gr4oxw_204">
       karma.config.d
      </code>
      in the root of your project. All
      <code class="code" id="-gr4oxw_205">
       .js
      </code>
      configuration files in this directory will be picked up and are automatically merged into the generated
      <code class="code" id="-gr4oxw_206">
       karma.conf.js
      </code>
      at build time.
     </p>
     <p id="-gr4oxw_200">
      All Karma configuration abilities are well described in Karma's
      <a data-external="true" href="https://karma-runner.github.io/5.0/config/configuration-file.html" id="-gr4oxw_208" rel="noopener noreferrer">
       documentation
      </a>
      .
     </p>
    </section>
   </section>
   <section class="chapter">
    <h2 data-toc="webpack-bundling" id="webpack-bundling">
     webpack bundling
    </h2>
    <p id="-gr4oxw_209">
     For browser targets, the Kotlin Multiplatform Gradle plugin uses the widely known
     <a data-external="true" href="https://webpack.js.org/" id="-gr4oxw_214" rel="noopener noreferrer">
      webpack
     </a>
     module bundler.
    </p>
    <section class="chapter">
     <h3 data-toc="webpack-version" id="webpack-version">
      webpack version
     </h3>
     <p id="-gr4oxw_215">
      The Kotlin Multiplatform plugin uses webpack 5.
     </p>
     <p id="-gr4oxw_216">
      If you have projects created with plugin versions earlier than 1.5.0, you can temporarily switch back to webpack 4 used in these versions by adding the following line to the project's
      <code class="code" id="-gr4oxw_218">
       gradle.properties
      </code>
      :
     </p>
     <div class="code-block" data-lang="none">
      kotlin.js.webpack.major.version=4
     </div>
    </section>
    <section class="chapter">
     <h3 data-toc="webpack-task" id="webpack-task">
      webpack task
     </h3>
     <p id="-gr4oxw_219">
      The most common webpack adjustments can be made directly via the
      <code class="code" id="-gr4oxw_223">
       kotlin.js.browser.webpackTask {}
      </code>
      configuration block in the Gradle build file:
     </p>
     <ul class="list _bullet" id="-gr4oxw_220">
      <li class="list__item" id="-gr4oxw_224">
       <p>
        <code class="code" id="-gr4oxw_226">
         outputFileName
        </code>
        - the name of the webpacked output file. It will be generated in
        <code class="code" id="-gr4oxw_227">
         &lt;projectDir&gt;/build/dist/&lt;targetName&gt;
        </code>
        after an execution of a webpack task. The default value is the project name.
       </p>
      </li>
      <li class="list__item" id="-gr4oxw_225">
       <p>
        <code class="code" id="-gr4oxw_228">
         output.libraryTarget
        </code>
        - the module system for the webpacked output. Learn more about
        <a data-tooltip="You can compile your Kotlin projects to JavaScript modules for various popular module systems. We currently support the following configurations for JavaScript modules:" href="js-modules.html" id="-gr4oxw_229">
         available module systems for Kotlin/JS projects
        </a>
        . The default value is
        <code class="code" id="-gr4oxw_230">
         umd
        </code>
        .
       </p>
      </li>
     </ul>
     <div class="code-block" data-lang="groovy">
      webpackTask {
    outputFileName = "mycustomfilename.js"
    output.libraryTarget = "commonjs2"
}
     </div>
     <p id="-gr4oxw_222">
      You can also configure common webpack settings to use in bundling, running, and testing tasks in the
      <code class="code" id="-gr4oxw_231">
       commonWebpackConfig {}
      </code>
      block.
     </p>
    </section>
    <section class="chapter">
     <h3 data-toc="webpack-configuration-file" id="webpack-configuration-file">
      webpack configuration file
     </h3>
     <p id="-gr4oxw_232">
      The Kotlin Multiplatform Gradle plugin automatically generates a standard webpack configuration file at the build time. It is located in
      <code class="code" id="-gr4oxw_237">
       build/js/packages/projectName/webpack.config.js
      </code>
      .
     </p>
     <p id="-gr4oxw_233">
      If you want to make further adjustments to the webpack configuration, place your additional configuration files inside a directory called
      <code class="code" id="-gr4oxw_238">
       webpack.config.d
      </code>
      in the root of your project. When building your project, all
      <code class="code" id="-gr4oxw_239">
       .js
      </code>
      configuration files will automatically be merged into the
      <code class="code" id="-gr4oxw_240">
       build/js/packages/projectName/webpack.config.js
      </code>
      file. For example, To add a new
      <a data-external="true" href="https://webpack.js.org/loaders/" id="-gr4oxw_241" rel="noopener noreferrer">
       webpack loader
      </a>
      , add the following to a
      <code class="code" id="-gr4oxw_242">
       .js
      </code>
      file inside the
      <code class="code" id="-gr4oxw_243">
       webpack.config.d
      </code>
      directory:
     </p>
     <aside class="prompt" data-title="" data-type="note" id="-gr4oxw_234">
      <p id="-gr4oxw_244">
       In this case, the configuration object is the
       <code class="code" id="-gr4oxw_245">
        config
       </code>
       global object. You need to modify it in your script.
      </p>
     </aside>
     <div class="code-block" data-lang="groovy">
      config.module.rules.push({
    test: /\.extension$/,
    loader: 'loader-name'
});
     </div>
     <p id="-gr4oxw_236">
      All webpack configuration capabilities are well described in its
      <a data-external="true" href="https://webpack.js.org/concepts/configuration/" id="-gr4oxw_246" rel="noopener noreferrer">
       documentation
      </a>
      .
     </p>
    </section>
    <section class="chapter">
     <h3 data-toc="building-executables" id="building-executables">
      Building executables
     </h3>
     <p id="-gr4oxw_247">
      For building executable JavaScript artifacts through webpack, the Kotlin Multiplatform Gradle plugin contains the
      <code class="code" id="-gr4oxw_252">
       browserDevelopmentWebpack
      </code>
      and
      <code class="code" id="-gr4oxw_253">
       browserProductionWebpack
      </code>
      Gradle tasks.
     </p>
     <ul class="list _bullet" id="-gr4oxw_248">
      <li class="list__item" id="-gr4oxw_254">
       <p id="-gr4oxw_256">
        <code class="code" id="-gr4oxw_257">
         browserDevelopmentWebpack
        </code>
        creates development artifacts, which are larger in size, but take little time to create. As such, use the
        <code class="code" id="-gr4oxw_258">
         browserDevelopmentWebpack
        </code>
        tasks during active development.
       </p>
      </li>
      <li class="list__item" id="-gr4oxw_255">
       <p id="-gr4oxw_259">
        <code class="code" id="-gr4oxw_260">
         browserProductionWebpack
        </code>
        applies dead code elimination to the generated artifacts and minifies the resulting JavaScript file, which takes more time, but generates executables that are smaller in size. As such, use the
        <code class="code" id="-gr4oxw_261">
         browserProductionWebpack
        </code>
        task when preparing your project for production use.
       </p>
      </li>
     </ul>
     <p id="-gr4oxw_249">
      Execute either of these tasks to obtain the respective artifacts for development or production. The generated files will be available in
      <code class="code" id="-gr4oxw_262">
       build/dist
      </code>
      unless
      <a data-tooltip="By default, the results of a Kotlin/JS project build reside in the /build/dist/&lt;targetName&gt;/&lt;binaryName&gt; directory within the project root." href="#distribution-target-directory" id="-gr4oxw_263">
       specified otherwise
      </a>
      .
     </p>
     <div class="code-block" data-lang="bash">
      ./gradlew browserProductionWebpack
     </div>
     <p id="-gr4oxw_251">
      Note that these tasks will only be available if your target is configured to generate executable files (via
      <code class="code" id="-gr4oxw_264">
       binaries.executable()
      </code>
      ).
     </p>
    </section>
   </section>
   <section class="chapter">
    <h2 data-toc="css" id="css">
     CSS
    </h2>
    <p id="-gr4oxw_265">
     The Kotlin Multiplatform Gradle plugin also provides support for webpack's
     <a data-external="true" href="https://webpack.js.org/loaders/css-loader/" id="-gr4oxw_274" rel="noopener noreferrer">
      CSS
     </a>
     and
     <a data-external="true" href="https://webpack.js.org/loaders/style-loader/" id="-gr4oxw_275" rel="noopener noreferrer">
      style
     </a>
     loaders. While all options can be changed by directly modifying the
     <a data-tooltip="For browser targets, the Kotlin Multiplatform Gradle plugin uses the widely known webpack module bundler." href="#webpack-bundling" id="-gr4oxw_276">
      webpack configuration files
     </a>
     that are used to build your project, the most commonly used settings are available directly from the
     <code class="code" id="-gr4oxw_277">
      build.gradle(.kts)
     </code>
     file.
    </p>
    <p id="-gr4oxw_266">
     To turn on CSS support in your project, set the
     <code class="code" id="-gr4oxw_278">
      cssSupport.enabled
     </code>
     option in the Gradle build file in the
     <code class="code" id="-gr4oxw_279">
      commonWebpackConfig {}
     </code>
     block. This configuration is also enabled by default when creating a new project using the wizard.
    </p>
    <div class="tabs" data-anchors="[-gr4oxw_280,-gr4oxw_281]" data-group="build-script" id="-gr4oxw_267">
     <div class="tabs__content" data-gtm="tab" data-sync-tabs="kotlin" data-title="Kotlin" id="-gr4oxw_280">
      <div class="code-block" data-lang="kotlin" data-title="Kotlin">
       browser {
    commonWebpackConfig {
        cssSupport {
            enabled.set(true)
        }
    }
}
      </div>
     </div>
     <div class="tabs__content" data-gtm="tab" data-sync-tabs="groovy" data-title="Groovy" id="-gr4oxw_281">
      <div class="code-block" data-lang="groovy" data-title="Groovy">
       browser {
    commonWebpackConfig {
        cssSupport {
            it.enabled = true
        }
    }
}
      </div>
     </div>
    </div>
    <p id="-gr4oxw_268">
     Alternatively, you can add CSS support independently for
     <code class="code" id="-gr4oxw_284">
      webpackTask {}
     </code>
     ,
     <code class="code" id="-gr4oxw_285">
      runTask {}
     </code>
     , and
     <code class="code" id="-gr4oxw_286">
      testTask {}
     </code>
     :
    </p>
    <div class="tabs" data-anchors="[-gr4oxw_287,-gr4oxw_288]" data-group="build-script" id="-gr4oxw_269">
     <div class="tabs__content" data-gtm="tab" data-sync-tabs="kotlin" data-title="Kotlin" id="-gr4oxw_287">
      <div class="code-block" data-lang="kotlin" data-title="Kotlin">
       browser {
    webpackTask {
        cssSupport {
            enabled.set(true)
        }
    }
    runTask {
        cssSupport {
            enabled.set(true)
        }
    }
    testTask {
        useKarma {
            // ...
            webpackConfig.cssSupport {
                enabled.set(true)
            }
        }
    }
}
      </div>
     </div>
     <div class="tabs__content" data-gtm="tab" data-sync-tabs="groovy" data-title="Groovy" id="-gr4oxw_288">
      <div class="code-block" data-lang="groovy" data-title="Groovy">
       browser {
    webpackTask {
        cssSupport {
            it.enabled = true
        }
    }
    runTask {
        cssSupport {
            it.enabled = true
        }
    }
    testTask {
        useKarma {
            // ...
            webpackConfig.cssSupport {
                it.enabled = true
            }
        }
    }
}
      </div>
     </div>
    </div>
    <p id="-gr4oxw_270">
     Activating CSS support in your project helps prevent common errors that occur when trying to use style sheets from an unconfigured project, such as
     <code class="code" id="-gr4oxw_291">
      Module parse failed: Unexpected character '@' (14:0)
     </code>
     .
    </p>
    <p id="-gr4oxw_271">
     You can use
     <code class="code" id="-gr4oxw_292">
      cssSupport.mode
     </code>
     to specify how encountered CSS should be handled. The following values are available:
    </p>
    <ul class="list _bullet" id="-gr4oxw_272">
     <li class="list__item" id="-gr4oxw_293">
      <p>
       <code class="code" id="-gr4oxw_296">
        "inline"
       </code>
       (default): styles are added to the global
       <code class="code" id="-gr4oxw_297">
        &lt;style&gt;
       </code>
       tag.
      </p>
     </li>
     <li class="list__item" id="-gr4oxw_294">
      <p>
       <code class="code" id="-gr4oxw_298">
        "extract"
       </code>
       : styles are extracted into a separate file. They can then be included from an HTML page.
      </p>
     </li>
     <li class="list__item" id="-gr4oxw_295">
      <p>
       <code class="code" id="-gr4oxw_299">
        "import"
       </code>
       : styles are processed as strings. This can be useful if you need access to the CSS from your code (such as
       <code class="code" id="-gr4oxw_300">
        val styles = require("main.css")
       </code>
       ).
      </p>
     </li>
    </ul>
    <p id="-gr4oxw_273">
     To use different modes for the same project, use
     <code class="code" id="-gr4oxw_301">
      cssSupport.rules
     </code>
     . Here, you can specify a list of
     <code class="code" id="-gr4oxw_302">
      KotlinWebpackCssRules
     </code>
     , each of which defines a mode, as well as
     <a data-external="true" href="https://webpack.js.org/configuration/module/#ruleinclude" id="-gr4oxw_303" rel="noopener noreferrer">
      include
     </a>
     and
     <a data-external="true" href="https://webpack.js.org/configuration/module/#ruleexclude" id="-gr4oxw_304" rel="noopener noreferrer">
      exclude
     </a>
     patterns.
    </p>
   </section>
   <section class="chapter">
    <h2 data-toc="node-js" id="node-js">
     Node.js
    </h2>
    <p id="-gr4oxw_305">
     For Kotlin/JS projects targeting Node.js, the plugin automatically downloads and installs the Node.js environment on the host. You can also use an existing Node.js instance if you have it.
    </p>
    <section class="chapter">
     <h3 data-toc="configuring-node-js-settings" id="configuring-node-js-settings">
      Configuring Node.js settings
     </h3>
     <p id="-gr4oxw_308">
      You can configure Node.js settings for each subproject, or set them for the project as a whole.
     </p>
     <p id="-gr4oxw_309">
      For example, to set the Node.js version for a specific subproject, add the following lines to its Gradle block in your
      <code class="code" id="-gr4oxw_314">
       build.gradle(.kts)
      </code>
      file:
     </p>
     <div class="tabs" data-anchors="[-gr4oxw_315,-gr4oxw_316]" data-group="build-script" id="-gr4oxw_310">
      <div class="tabs__content" data-gtm="tab" data-sync-tabs="kotlin" data-title="Kotlin" id="-gr4oxw_315">
       <div class="code-block" data-lang="kotlin" data-title="Kotlin">
        project.plugins.withType&lt;org.jetbrains.kotlin.gradle.targets.js.nodejs.NodeJsPlugin&gt; {
    project.the&lt;org.jetbrains.kotlin.gradle.targets.js.nodejs.NodeJsEnvSpec&gt;().version = "your Node.js version"
}
       </div>
      </div>
      <div class="tabs__content" data-gtm="tab" data-sync-tabs="groovy" data-title="Groovy" id="-gr4oxw_316">
       <div class="code-block" data-lang="groovy" data-title="Groovy">
        project.plugins.withType(org.jetbrains.kotlin.gradle.targets.js.nodejs.NodeJsPlugin) {
    project.extensions.getByType(org.jetbrains.kotlin.gradle.targets.js.nodejs.NodeJsEnvSpec).version = "your Node.js version"
}
       </div>
      </div>
     </div>
     <p id="-gr4oxw_311">
      To set a version for the entire project, including all subprojects, apply the same code to the
      <code class="code" id="-gr4oxw_319">
       allProjects {}
      </code>
      block:
     </p>
     <div class="tabs" data-anchors="[-gr4oxw_320,-gr4oxw_321]" data-group="build-script" id="-gr4oxw_312">
      <div class="tabs__content" data-gtm="tab" data-sync-tabs="kotlin" data-title="Kotlin" id="-gr4oxw_320">
       <div class="code-block" data-lang="kotlin" data-title="Kotlin">
        allprojects {
    project.plugins.withType&lt;org.jetbrains.kotlin.gradle.targets.js.nodejs.NodeJsPlugin&gt; {
        project.the&lt;org.jetbrains.kotlin.gradle.targets.js.nodejs.NodeJsEnvSpec&gt;().version = "your Node.js version"
    }
}
       </div>
      </div>
      <div class="tabs__content" data-gtm="tab" data-sync-tabs="groovy" data-title="Groovy" id="-gr4oxw_321">
       <div class="code-block" data-lang="groovy" data-title="Groovy">
        allprojects {
    project.plugins.withType(org.jetbrains.kotlin.gradle.targets.js.nodejs.NodeJsPlugin) {
        project.extensions.getByType(org.jetbrains.kotlin.gradle.targets.js.nodejs.NodeJsEnvSpec).version = "your Node.js version"
}
       </div>
      </div>
     </div>
     <aside class="prompt" data-title="" data-type="note" id="-gr4oxw_313">
      <p id="-gr4oxw_324">
       Using the
       <code class="code" id="-gr4oxw_325">
        NodeJsRootPlugin
       </code>
       class to configure Node.js setting for the entire project is deprecated and will eventually stop being supported.
      </p>
     </aside>
    </section>
    <section class="chapter">
     <h3 data-toc="use-pre-installed-node-js" id="use-pre-installed-node-js">
      Use pre-installed Node.js
     </h3>
     <p id="-gr4oxw_326">
      If Node.js is already installed on the host where you build Kotlin/JS projects, you can configure the Kotlin Multiplatform Gradle plugin to use it instead of installing its own Node.js instance.
     </p>
     <p id="-gr4oxw_327">
      To use a pre-installed Node.js instance, add the following lines to your
      <code class="code" id="-gr4oxw_329">
       build.gradle(.kts)
      </code>
      file:
     </p>
     <div class="tabs" data-anchors="[-gr4oxw_330,-gr4oxw_331]" data-group="build-script" id="-gr4oxw_328">
      <div class="tabs__content" data-gtm="tab" data-sync-tabs="kotlin" data-title="Kotlin" id="-gr4oxw_330">
       <div class="code-block" data-lang="kotlin" data-title="Kotlin">
        project.plugins.withType(org.jetbrains.kotlin.gradle.targets.js.nodejs.NodeJsPlugin) {
    // Set to `true` for default behavior
    project.extensions.getByType(org.jetbrains.kotlin.gradle.targets.js.nodejs.NodeJsEnvSpec).download = false
}
       </div>
      </div>
      <div class="tabs__content" data-gtm="tab" data-sync-tabs="groovy" data-title="Groovy" id="-gr4oxw_331">
       <div class="code-block" data-lang="groovy" data-title="Groovy">
        project.plugins.withType&lt;org.jetbrains.kotlin.gradle.targets.js.nodejs.NodeJsPlugin&gt; {
    // Set to `true` for default behavior
    project.the&lt;org.jetbrains.kotlin.gradle.targets.js.nodejs.NodeJsEnvSpec&gt;().download = false
}
       </div>
      </div>
     </div>
    </section>
   </section>
   <section class="chapter">
    <h2 data-toc="yarn" id="yarn">
     Yarn
    </h2>
    <p id="-gr4oxw_334">
     By default, to download and install your declared dependencies at build time, the plugin manages its own instance of the
     <a data-external="true" href="https://yarnpkg.com/lang/en/" id="-gr4oxw_340" rel="noopener noreferrer">
      Yarn
     </a>
     package manager. It works out of the box without additional configuration, but you can tune it or use Yarn already installed on your host.
    </p>
    <section class="chapter">
     <h3 data-toc="additional-yarn-features-yarnrc" id="additional-yarn-features-yarnrc">
      Additional Yarn features: .yarnrc
     </h3>
     <p id="-gr4oxw_341">
      To configure additional Yarn features, place a
      <code class="code" id="-gr4oxw_345">
       .yarnrc
      </code>
      file in the root of your project. At build time, it gets picked up automatically.
     </p>
     <p id="-gr4oxw_342">
      For example, to use a custom registry for npm packages, add the following line to a file called
      <code class="code" id="-gr4oxw_346">
       .yarnrc
      </code>
      in the project root:
     </p>
     <div class="code-block" data-lang="none">
      registry "http://my.registry/api/npm/"
     </div>
     <p id="-gr4oxw_344">
      To learn more about
      <code class="code" id="-gr4oxw_347">
       .yarnrc
      </code>
      , visit the
      <a data-external="true" href="https://classic.yarnpkg.com/en/docs/yarnrc/" id="-gr4oxw_348" rel="noopener noreferrer">
       official Yarn documentation
      </a>
      .
     </p>
    </section>
    <section class="chapter">
     <h3 data-toc="use-pre-installed-yarn" id="use-pre-installed-yarn">
      Use pre-installed Yarn
     </h3>
     <p id="-gr4oxw_349">
      If Yarn is already installed on the host where you build Kotlin/JS projects, you can configure the Kotlin Multiplatform Gradle plugin to use it instead of installing its own Yarn instance.
     </p>
     <p id="-gr4oxw_350">
      To use the pre-installed Yarn instance, add the following lines to
      <code class="code" id="-gr4oxw_352">
       build.gradle(.kts)
      </code>
      :
     </p>
     <div class="tabs" data-anchors="[-gr4oxw_353,-gr4oxw_354]" data-group="build-script" id="-gr4oxw_351">
      <div class="tabs__content" data-gtm="tab" data-sync-tabs="kotlin" data-title="Kotlin" id="-gr4oxw_353">
       <div class="code-block" data-lang="kotlin" data-title="Kotlin">
        rootProject.plugins.withType&lt;org.jetbrains.kotlin.gradle.targets.js.yarn.YarnPlugin&gt; {
    rootProject.the&lt;org.jetbrains.kotlin.gradle.targets.js.yarn.YarnRootExtension&gt;().download = false
    // "true" for default behavior
}
       </div>
      </div>
      <div class="tabs__content" data-gtm="tab" data-sync-tabs="groovy" data-title="Groovy" id="-gr4oxw_354">
       <div class="code-block" data-lang="groovy" data-title="Groovy">
        rootProject.plugins.withType(org.jetbrains.kotlin.gradle.targets.js.yarn.YarnPlugin) {
    rootProject.extensions.getByType(org.jetbrains.kotlin.gradle.targets.js.yarn.YarnRootExtension).download = false
}
       </div>
      </div>
     </div>
    </section>
    <section class="chapter">
     <h3 data-toc="version-locking-via-kotlin-js-store" id="version-locking-via-kotlin-js-store">
      Version locking via kotlin-js-store
     </h3>
     <aside class="prompt" data-title="" data-type="note" id="-gr4oxw_357">
      <p id="-gr4oxw_364">
       Version locking via
       <code class="code" id="-gr4oxw_365">
        kotlin-js-store
       </code>
       is available since Kotlin 1.6.10.
      </p>
     </aside>
     <p id="-gr4oxw_358">
      The
      <code class="code" id="-gr4oxw_366">
       kotlin-js-store
      </code>
      directory in the project root is automatically generated by the Kotlin Multiplatform Gradle plugin to hold the
      <code class="code" id="-gr4oxw_367">
       yarn.lock
      </code>
      file, which is necessary for version locking. The lockfile is entirely managed by the Yarn plugin and gets updated during the execution of the
      <code class="code" id="-gr4oxw_368">
       kotlinNpmInstall
      </code>
      Gradle task.
     </p>
     <p id="-gr4oxw_359">
      To follow a
      <a data-external="true" href="https://classic.yarnpkg.com/blog/2016/11/24/lockfiles-for-all/" id="-gr4oxw_369" rel="noopener noreferrer">
       recommended practice
      </a>
      , commit
      <code class="code" id="-gr4oxw_370">
       kotlin-js-store
      </code>
      and its contents to your version control system. It ensures that your application is being built with the exact same dependency tree on all machines.
     </p>
     <p id="-gr4oxw_360">
      If needed, you can change both directory and lockfile names in
      <code class="code" id="-gr4oxw_371">
       build.gradle(.kts)
      </code>
      :
     </p>
     <div class="tabs" data-anchors="[-gr4oxw_372,-gr4oxw_373]" data-group="build-script" id="-gr4oxw_361">
      <div class="tabs__content" data-gtm="tab" data-sync-tabs="kotlin" data-title="Kotlin" id="-gr4oxw_372">
       <div class="code-block" data-lang="kotlin" data-title="Kotlin">
        rootProject.plugins.withType&lt;org.jetbrains.kotlin.gradle.targets.js.yarn.YarnPlugin&gt; {
    rootProject.the&lt;org.jetbrains.kotlin.gradle.targets.js.yarn.YarnRootExtension&gt;().lockFileDirectory =
        project.rootDir.resolve("my-kotlin-js-store")
    rootProject.the&lt;org.jetbrains.kotlin.gradle.targets.js.yarn.YarnRootExtension&gt;().lockFileName = "my-yarn.lock"
}
       </div>
      </div>
      <div class="tabs__content" data-gtm="tab" data-sync-tabs="groovy" data-title="Groovy" id="-gr4oxw_373">
       <div class="code-block" data-lang="groovy" data-title="Groovy">
        rootProject.plugins.withType(org.jetbrains.kotlin.gradle.targets.js.yarn.YarnPlugin) {
    rootProject.extensions.getByType(org.jetbrains.kotlin.gradle.targets.js.yarn.YarnRootExtension).lockFileDirectory =
        file("my-kotlin-js-store")
    rootProject.extensions.getByType(org.jetbrains.kotlin.gradle.targets.js.yarn.YarnRootExtension).lockFileName = 'my-yarn.lock'
}
       </div>
      </div>
     </div>
     <aside class="prompt" data-title="" data-type="warning" id="-gr4oxw_362">
      <p id="-gr4oxw_376">
       Changing the name of the lockfile may cause dependency inspection tools to no longer pick up the file.
      </p>
     </aside>
     <p id="-gr4oxw_363">
      To learn more about
      <code class="code" id="-gr4oxw_377">
       yarn.lock
      </code>
      , visit the
      <a data-external="true" href="https://classic.yarnpkg.com/lang/en/docs/yarn-lock/" id="-gr4oxw_378" rel="noopener noreferrer">
       official Yarn documentation
      </a>
      .
     </p>
    </section>
    <section class="chapter">
     <h3 data-toc="reporting-that-yarn-lock-has-been-updated" id="reporting-that-yarn-lock-has-been-updated">
      Reporting that yarn.lock has been updated
     </h3>
     <p id="-gr4oxw_379">
      Kotlin/JS provides Gradle settings that could notify you if the
      <code class="code" id="-gr4oxw_383">
       yarn.lock
      </code>
      file has been updated. You can use these settings when you want to be notified if
      <code class="code" id="-gr4oxw_384">
       yarn.lock
      </code>
      has been changed silently during the CI build process:
     </p>
     <ul class="list _bullet" id="-gr4oxw_380">
      <li class="list__item" id="-gr4oxw_385">
       <p>
        <code class="code" id="-gr4oxw_388">
         YarnLockMismatchReport
        </code>
        , which specifies how changes to the
        <code class="code" id="-gr4oxw_389">
         yarn.lock
        </code>
        file are reported. You can use one of the following values:
       </p>
       <ul class="list _bullet" id="-gr4oxw_390">
        <li class="list__item" id="-gr4oxw_391">
         <p>
          <code class="code" id="-gr4oxw_394">
           FAIL
          </code>
          fails the corresponding Gradle task. This is the default.
         </p>
        </li>
        <li class="list__item" id="-gr4oxw_392">
         <p>
          <code class="code" id="-gr4oxw_395">
           WARNING
          </code>
          writes the information about changes in the warning log.
         </p>
        </li>
        <li class="list__item" id="-gr4oxw_393">
         <p>
          <code class="code" id="-gr4oxw_396">
           NONE
          </code>
          disables reporting.
         </p>
        </li>
       </ul>
      </li>
      <li class="list__item" id="-gr4oxw_386">
       <p>
        <code class="code" id="-gr4oxw_397">
         reportNewYarnLock
        </code>
        , which reports about the recently created
        <code class="code" id="-gr4oxw_398">
         yarn.lock
        </code>
        file explicitly. By default, this option is disabled: it's a common practice to generate a new
        <code class="code" id="-gr4oxw_399">
         yarn.lock
        </code>
        file at the first start. You can use this option to ensure that the file has been committed to your repository.
       </p>
      </li>
      <li class="list__item" id="-gr4oxw_387">
       <p>
        <code class="code" id="-gr4oxw_400">
         yarnLockAutoReplace
        </code>
        , which replaces
        <code class="code" id="-gr4oxw_401">
         yarn.lock
        </code>
        automatically every time the Gradle task is run.
       </p>
      </li>
     </ul>
     <p id="-gr4oxw_381">
      To use these options, update
      <code class="code" id="-gr4oxw_402">
       build.gradle(.kts)
      </code>
      as follows:
     </p>
     <div class="tabs" data-anchors="[-gr4oxw_403,-gr4oxw_404]" data-group="build-script" id="-gr4oxw_382">
      <div class="tabs__content" data-gtm="tab" data-sync-tabs="kotlin" data-title="Kotlin" id="-gr4oxw_403">
       <div class="code-block" data-lang="kotlin" data-title="Kotlin">
        import org.jetbrains.kotlin.gradle.targets.js.yarn.YarnLockMismatchReport
import org.jetbrains.kotlin.gradle.targets.js.yarn.YarnRootExtension

rootProject.plugins.withType(org.jetbrains.kotlin.gradle.targets.js.yarn.YarnPlugin::class.java) {
    rootProject.the&lt;YarnRootExtension&gt;().yarnLockMismatchReport =
        YarnLockMismatchReport.WARNING // NONE | FAIL
    rootProject.the&lt;YarnRootExtension&gt;().reportNewYarnLock = false // true
    rootProject.the&lt;YarnRootExtension&gt;().yarnLockAutoReplace = false // true
}
       </div>
      </div>
      <div class="tabs__content" data-gtm="tab" data-sync-tabs="groovy" data-title="Groovy" id="-gr4oxw_404">
       <div class="code-block" data-lang="groovy" data-title="Groovy">
        import org.jetbrains.kotlin.gradle.targets.js.yarn.YarnLockMismatchReport
import org.jetbrains.kotlin.gradle.targets.js.yarn.YarnRootExtension

rootProject.plugins.withType(org.jetbrains.kotlin.gradle.targets.js.yarn.YarnPlugin) {
    rootProject.extensions.getByType(org.jetbrains.kotlin.gradle.targets.js.yarn.YarnRootExtension).yarnLockMismatchReport =
        YarnLockMismatchReport.WARNING // NONE | FAIL
    rootProject.extensions.getByType(org.jetbrains.kotlin.gradle.targets.js.yarn.YarnRootExtension).reportNewYarnLock = false // true
    rootProject.extensions.getByType(org.jetbrains.kotlin.gradle.targets.js.yarn.YarnRootExtension).yarnLockAutoReplace = false // true
}
       </div>
      </div>
     </div>
    </section>
    <section class="chapter">
     <h3 data-toc="installing-npm-dependencies-with-ignore-scripts-by-default" id="installing-npm-dependencies-with-ignore-scripts-by-default">
      Installing npm dependencies with --ignore-scripts by default
     </h3>
     <aside class="prompt" data-title="" data-type="note" id="-gr4oxw_407">
      <p id="-gr4oxw_411">
       Installing npm dependencies with
       <code class="code" id="-gr4oxw_412">
        --ignore-scripts
       </code>
       by default is available since Kotlin 1.6.10.
      </p>
     </aside>
     <p id="-gr4oxw_408">
      To reduce the likelihood of executing malicious code from compromised npm packages, the Kotlin Multiplatform Gradle plugin prevents the execution of
      <a data-external="true" href="https://docs.npmjs.com/cli/v8/using-npm/scripts#life-cycle-scripts" id="-gr4oxw_413" rel="noopener noreferrer">
       lifecycle scripts
      </a>
      during the installation of npm dependencies by default.
     </p>
     <p id="-gr4oxw_409">
      You can explicitly enable lifecycle scripts execution by adding the following lines to
      <code class="code" id="-gr4oxw_414">
       build.gradle(.kts)
      </code>
      :
     </p>
     <div class="tabs" data-anchors="[-gr4oxw_415,-gr4oxw_416]" data-group="build-script" id="-gr4oxw_410">
      <div class="tabs__content" data-gtm="tab" data-sync-tabs="kotlin" data-title="Kotlin" id="-gr4oxw_415">
       <div class="code-block" data-lang="kotlin" data-title="Kotlin">
        rootProject.plugins.withType&lt;org.jetbrains.kotlin.gradle.targets.js.yarn.YarnPlugin&gt; { 
    rootProject.the&lt;org.jetbrains.kotlin.gradle.targets.js.yarn.YarnRootExtension&gt;().ignoreScripts = false
}
       </div>
      </div>
      <div class="tabs__content" data-gtm="tab" data-sync-tabs="groovy" data-title="Groovy" id="-gr4oxw_416">
       <div class="code-block" data-lang="groovy" data-title="Groovy">
        rootProject.plugins.withType(org.jetbrains.kotlin.gradle.targets.js.yarn.YarnPlugin) {
    rootProject.extensions.getByType(org.jetbrains.kotlin.gradle.targets.js.yarn.YarnRootExtension).ignoreScripts = false
}
       </div>
      </div>
     </div>
    </section>
   </section>
   <section class="chapter">
    <h2 data-toc="distribution-target-directory" id="distribution-target-directory">
     Distribution target directory
    </h2>
    <p id="-gr4oxw_419">
     By default, the results of a Kotlin/JS project build reside in the
     <code class="code" id="-gr4oxw_423">
      /build/dist/&lt;targetName&gt;/&lt;binaryName&gt;
     </code>
     directory within the project root.
    </p>
    <aside class="prompt" data-title="" data-type="note" id="-gr4oxw_420">
     <p id="-gr4oxw_424">
      Prior to Kotlin 1.9.0, the default distribution target directory was
      <code class="code" id="-gr4oxw_425">
       /build/distributions
      </code>
      .
     </p>
    </aside>
    <p id="-gr4oxw_421">
     To set another location for project distribution files, in your build script inside the
     <code class="code" id="-gr4oxw_426">
      browser {}
     </code>
     block, add a
     <code class="code" id="-gr4oxw_427">
      distribution {}
     </code>
     block and assign a value to the
     <code class="code" id="-gr4oxw_428">
      outputDirectory
     </code>
     property by using the
     <code class="code" id="-gr4oxw_429">
      set()
     </code>
     method. Once you run a project build task, Gradle will save the output bundle in this location together with project resources.
    </p>
    <div class="tabs" data-anchors="[-gr4oxw_430,-gr4oxw_431]" data-group="build-script" id="-gr4oxw_422">
     <div class="tabs__content" data-gtm="tab" data-sync-tabs="kotlin" data-title="Kotlin" id="-gr4oxw_430">
      <div class="code-block" data-lang="kotlin" data-title="Kotlin">
       kotlin {
    js {
        browser {
            distribution {
                outputDirectory.set(projectDir.resolve("output"))
            }
        }
        binaries.executable()
        // ...
    }
}
      </div>
     </div>
     <div class="tabs__content" data-gtm="tab" data-sync-tabs="groovy" data-title="Groovy" id="-gr4oxw_431">
      <div class="code-block" data-lang="groovy" data-title="Groovy">
       kotlin {
    js {
        browser {
            distribution {
                outputDirectory = file("$projectDir/output")
            }
        }
        binaries.executable()
        // ...
    }
}
      </div>
     </div>
    </div>
   </section>
   <section class="chapter">
    <h2 data-toc="module-name" id="module-name">
     Module name
    </h2>
    <p id="-gr4oxw_434">
     To adjust the name for the JavaScript
     <span class="emphasis" id="-gr4oxw_437">
      module
     </span>
     (which is generated in
     <code class="code" id="-gr4oxw_438">
      build/js/packages/myModuleName
     </code>
     ), including the corresponding
     <code class="code" id="-gr4oxw_439">
      .js
     </code>
     and
     <code class="code" id="-gr4oxw_440">
      .d.ts
     </code>
     files, use the
     <code class="code" id="-gr4oxw_441">
      moduleName
     </code>
     option:
    </p>
    <div class="code-block" data-lang="groovy">
     js {
    moduleName = "myModuleName"
}
    </div>
    <p id="-gr4oxw_436">
     Note that this does not affect the webpacked output in
     <code class="code" id="-gr4oxw_442">
      build/dist
     </code>
     .
    </p>
   </section>
   <section class="chapter">
    <h2 data-toc="package-json-customization" id="package-json-customization">
     package.json customization
    </h2>
    <p id="-gr4oxw_443">
     The
     <code class="code" id="-gr4oxw_451">
      package.json
     </code>
     file holds the metadata of a JavaScript package. Popular package registries such as npm require all published packages to have such a file. They use it to track and manage package publications.
    </p>
    <p id="-gr4oxw_444">
     The Kotlin Multiplatform Gradle plugin automatically generates
     <code class="code" id="-gr4oxw_452">
      package.json
     </code>
     for Kotlin/JS projects during build time. By default, the file contains essential data: name, version, license, dependencies, and some other package attributes.
    </p>
    <p id="-gr4oxw_445">
     Aside from basic package attributes,
     <code class="code" id="-gr4oxw_453">
      package.json
     </code>
     can define how a JavaScript project should behave, for example, identifying scripts that are available to run.
    </p>
    <p id="-gr4oxw_446">
     You can add custom entries to the project's
     <code class="code" id="-gr4oxw_454">
      package.json
     </code>
     via the Gradle DSL. To add custom fields to your
     <code class="code" id="-gr4oxw_455">
      package.json
     </code>
     , use the
     <code class="code" id="-gr4oxw_456">
      customField()
     </code>
     function in the compilations
     <code class="code" id="-gr4oxw_457">
      packageJson
     </code>
     block:
    </p>
    <div class="code-block" data-lang="kotlin">
     kotlin {
    js {
        compilations["main"].packageJson {
            customField("hello", mapOf("one" to 1, "two" to 2))
        }
    }
}
    </div>
    <p id="-gr4oxw_448">
     When you build the project, this code adds the following block to the
     <code class="code" id="-gr4oxw_458">
      package.json
     </code>
     file:
    </p>
    <div class="code-block" data-lang="json">
     "hello": {
    "one": 1,
    "two": 2
}
    </div>
    <p id="-gr4oxw_450">
     Learn more about writing
     <code class="code" id="-gr4oxw_459">
      package.json
     </code>
     files for npm registry in the
     <a data-external="true" href="https://docs.npmjs.com/cli/v6/configuring-npm/package-json" id="-gr4oxw_460" rel="noopener noreferrer">
      npm docs
     </a>
     .
    </p>
   </section>
   <div class="last-modified">
    Last modified: 16 December 2024
   </div>
   <div data-feedback-placeholder="true">
   </div>
  </div>
 </body>
</html>
